<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="21080" />

<meta name="date" content="2021-12-21" />

<title>Homework</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">21080</h4>
<h4 class="date">2021-12-21</h4>



<div id="question" class="section level2">
<h2>Question</h2>
<p>1.Go through “R for Beginners” if you are not familiar with R programming.</p>
<p>2.Use knitr to produce at least 3 examples (texts, figures, tables).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">dt&lt;-USPersonalExpenditure</a></code></pre></div>
<p>2(1).文字</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">n&lt;-<span class="kw">paste</span>(<span class="kw">row.names</span>(dt),<span class="dt">seq=</span><span class="st">&quot;,&quot;</span>)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">cat</span>(<span class="st">&quot;数据集USPersonalExpenditure收集了美国在1940,1945,1950,1955,1960年&quot;,n,&quot;</span>五个方面的消费。<span class="st">&quot;)</span></a></code></pre></div>
<pre><code>## 数据集USPersonalExpenditure收集了美国在1940,1945,1950,1955,1960年 Food and Tobacco , Household Operation , Medical and Health , Personal Care , Private Education , 五个方面的消费。</code></pre>
<p>2(2).图片</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">y&lt;-<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(dt))</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">plot</span>(y,dt[<span class="dv">1</span>,],<span class="dt">main=</span><span class="st">&quot;USPersonalExpenditure&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;年份&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;消费(十亿)&quot;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>),<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="dv">5</span>) {</a>
<a class="sourceLine" id="cb4-4" title="4">  <span class="kw">lines</span>(y,dt[i,],<span class="dt">col=</span>i)</a>
<a class="sourceLine" id="cb4-5" title="5">}</a>
<a class="sourceLine" id="cb4-6" title="6"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="kw">row.names</span>(dt),<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dt">lty=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>2(3).表格</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">dt</a></code></pre></div>
<pre><code>##                       1940   1945  1950 1955  1960
## Food and Tobacco    22.200 44.500 59.60 73.2 86.80
## Household Operation 10.500 15.500 29.00 36.5 46.20
## Medical and Health   3.530  5.760  9.71 14.0 21.10
## Personal Care        1.040  1.980  2.45  3.4  5.40
## Private Education    0.341  0.974  1.80  2.6  3.64</code></pre>
</div>
<div id="question-1" class="section level1">
<h1>Question</h1>
<p>Exercises 3.4, 3.11, and 3.20 (pages 94-96, Statistical Computating with R).</p>
</div>
<div id="answer-1" class="section level1">
<h1>Answer</h1>
<div id="rayleigh-density" class="section level2">
<h2>3.4:Rayleigh density</h2>
<p>由密度函数<span class="math inline">\(f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)},x\ge 0,\sigma&gt;0\)</span>， 可得分布函数<span class="math inline">\(F(x)=1-e^{-x^2/(2\sigma^2)},x\ge 0,\sigma&gt;0\)</span>， 故<span class="math inline">\(F^{-1}_{X}(u)=\sqrt{-2\sigma^2\log(1-u)}\)</span>. 而<span class="math inline">\(U\)</span>与<span class="math inline">\(1-U\)</span>同分布，故可进一步简化为<span class="math inline">\(F^{-1}_{X}(u)=\sqrt{-2\sigma^2\log(u)}\)</span>.</p>
<p>生成n个从Rayleigh density产生的随机数</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">rrayleigh&lt;-<span class="cf">function</span>(<span class="dt">n=</span><span class="dv">1000</span>,<span class="dt">sigma=</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb7-2" title="2">  <span class="kw">return</span>(<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="kw">runif</span>(n))))</a>
<a class="sourceLine" id="cb7-3" title="3">}</a></code></pre></div>
<p>生成<span class="math inline">\(\sigma=\frac{1}{4},\frac{1}{2},1,2,4,10\)</span>的随机数并作图</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">hist</span>(<span class="kw">rrayleigh</span>(<span class="dt">sigma =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>))</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="kw">hist</span>(<span class="kw">rrayleigh</span>(<span class="dt">sigma =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb8-4" title="4"><span class="kw">hist</span>(<span class="kw">rrayleigh</span>(<span class="dt">sigma =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb8-5" title="5"><span class="kw">hist</span>(<span class="kw">rrayleigh</span>(<span class="dt">sigma =</span> <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb8-6" title="6"><span class="kw">hist</span>(<span class="kw">rrayleigh</span>(<span class="dt">sigma =</span> <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb8-7" title="7"><span class="kw">hist</span>(<span class="kw">rrayleigh</span>(<span class="dt">sigma =</span> <span class="dv">10</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>上图显示：生成的随机数随<span class="math inline">\(\sigma\)</span>变化的规律与密度函数的理论表达一致——<span class="math inline">\(\sigma\)</span>越大，随机数取值的跨度越大</p>
</div>
<div id="bimodal-mixture" class="section level2">
<h2>3.11:bimodal mixture</h2>
<p><span class="math inline">\(p_1=0.75\)</span>时模拟柱状图</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">rbimodal&lt;-<span class="cf">function</span>(<span class="dt">n=</span><span class="dv">1000</span>,p){</a>
<a class="sourceLine" id="cb9-2" title="2">  <span class="kw">return</span>(<span class="kw">rnorm</span>(n,<span class="dt">mean =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>),n,<span class="dt">replace =</span> T,<span class="dt">prob =</span> <span class="kw">c</span>(p,<span class="dv">1</span><span class="op">-</span>p))))</a>
<a class="sourceLine" id="cb9-3" title="3">}</a>
<a class="sourceLine" id="cb9-4" title="4"><span class="kw">hist</span>(<span class="kw">rbimodal</span>(<span class="dt">p=</span><span class="fl">0.75</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">hist</span>(<span class="kw">rbimodal</span>(<span class="dt">p =</span> <span class="fl">0.9</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">hist</span>(<span class="kw">rbimodal</span>(<span class="dt">p =</span> <span class="fl">0.75</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">hist</span>(<span class="kw">rbimodal</span>(<span class="dt">p =</span> <span class="fl">0.6</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">hist</span>(<span class="kw">rbimodal</span>(<span class="dt">p =</span> <span class="fl">0.55</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">hist</span>(<span class="kw">rbimodal</span>(<span class="dt">p =</span> <span class="fl">0.5</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAvVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkJBmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2ZpC2kDq2kGa225C227a229u22/+2/7a2/9u2///T09PbkDrbkGbbtmbbtpDb27bb29vb////tmb/25D/27b//7b//9v///+JhdvgAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALMklEQVR4nO2dbWOcuBWFsdeuJ+72xd5k28bepJuadLet2y5JtsbxzP//WdUrgwDpICPwoDnnw9ijQVfSw0UScBHFjgqqeOkKHLoICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICMgLaHtbnD/ovxfNl9bPf/9v4ppsP26K4g9OUlmc2lL6NfCplamV8en65G5UJYri5E/7gqrimYC+vj5NDaguhK6cpISAqlHZxcZSFy1j4wChWqRQVfT28bNKGQQkPq+8OZw6fNh9Koob8/3pOs6DPl0KB/z9vQJbqHp8eVMU32iXlN55dqeqJ8r58XVxer/78lps9+2dKuniy2Vx8nb3aSO22hfTGFAmDSKbXxj7p/hdlqhqMGTFqYFI/aABNSXrqtfKtLF3dm8Kf9wUWqZc7Qwtl5AbRACqtDVRvgVkUuSG2jtPLvfJ5w91U7zcFUqXFq3dZdaAC0gnlkVTogXUtdKrgf5hX7Ktutza2rOu2gUk7Es/K5vDUZoJALK62O+/h91n1VHo3SQK0NyulK2Lh21puZ3f7/4ncv3mQW50pQBdybzFW7O9rWFjoHWImfyyQeLv53YNOlb6Nfgoa9AqWWU0TiFrZ+wNAlIZ2gdpGQVIZD/7187m1HtEWSq1U8n/RRM0IHsU//rzpTQg0kVD9Kepxt7Mzh6XLUA3+meVVOomK0AdK74a7Etu9q1u780u0LV1AW3fbc4iAOkUfbyXjdvv9L63/ztt3b6zBnQN9eceUNuAC0j/W9rDyNjvWenU4KLJtC/Z7tsr194oQFIxfdDX19of/2ZsmP0iffvG/t8GJIme/fXXay+gtoFhQO4O6Fnx1aBV8gCg2jo4PMQiAYnpz/tL26WO8CBd3pMfUGoPamrQKjnkQbCTjgYkv/+wP979fZAqUe+p1q7uAvL3QRZQ02cMA/LVoFWyC8jtgwaGeT1nsp34m81VBCBR6h/VcabGDWnTP4pZDzp/+Hrr74P8o1gD6LQzinWseGrQKrnTSTujWE+VmmNJjLbXPYnxoI973DWYBzV9ULCTdqYxw4C686CulZaB1uatkjvDvLXnbbTOZVocOVHcfZY90LdyHqqmzfdmHvtnnUEk/e6+N4qdfZCTNB+gloHhPqg3k+5aadfgp03xzdtmFNMl24niuZqtn/7nnbbna7WYjKuTVdPir29SX+5wOrjDUXOqEX1ulwxQqa5ViP3qO75fVMIhbl4YUN05zzkwVXLHvSggcbhuzLn+IerpupkIxImXXIEICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICA4gDZ2ynJo6cOV1GAKnu/ph4Vr5WFYgBtb/c3/A7y5s4cigH0dG2jfnb10Rxk9CCgyD7IuBD7II9sFOXR+A/nQVAEBMSJIhAnikAc5oHSTBSbkOr8urTEHnTcgEZMFGcBVHQ0Rxn+wqO2hhPFeQD94uiQAc1jrushXSME9EuYwIoAybBt1Q1VnqnikQOq1LODMs6XgIakh/ntrYxcJ6AB2Ylief5AQENqJorlBQENymJpngudZq7JlA2gZiq9vSWgBc0REMpEQCATAYFMqwBkHztPZC4q0yoA6ROtqZeaswa0S8Aod0Aa0YSbOpkDqgv9TP3zb1ksAmjRS7B76/JyqiYzIbZlEUBg87RqjWIpnlceV9muC6wC0JLmIlt8KIBKtRjatIE+Z0Cl6oD0FdUE5oJbrRGQvVz4rB46ckRZJSB7udB3rTDSXHirNQIyF8MeNwvMpNcJSC9YNXGszxrQcuYICG21SkBJ4g9zBlSmiMzMGNDTdYq4zKwB3YS2izUX3mqNgLa3KVZnyxiQOE9N4EIZA2pW++Yo5hb+EubyBQTnSlkDUkuhl6HBHj+rkTOg+uSukuvJ+gkli7RHLQ5fs37B60FVIPpwN+qh3jSAwt9fcKIoAQWuKC7mQQcJyHpQGbhrmOpZjVUCMn1QFZwuJnpWY52AdOsP4origQJazly+gBaaKB4koDHnYktNFA8SkFHovuFxD/NWpf+yULKHelcNiBNF0KLQrefjnihqhaM7jnmimGblm4wBLWmOgNBWawTUTBQnXbfPGJC57RM6mx/BcLiysZcIDxLQ9laTCS18433QsG/OTY1s8UECevpOX+gIxijC268ZA7IeFLqiiG+/ZgxIXlHc6cUVkphzUrMApPvgiUtvZQ1oPnMEBMxlAgjfeo4y107NAhC+9RxlzknNAdCIW88x5tzUHACNuPUcY85NnRfQrI9oRt16jjDnps4LqPt9Qv1DLRpz6znCnJOaBaAZbz1nAmg+c1kAat3TSWHOTc0B0JyR9lkAmjS+gyE2C0BzBpJnAWhOcwQEzK0fUJoeepc5oBQDPQGNMtdLJSDXXC+VgFxzvVQCcs31UgnINddLzQBQitCOXb6AZjZHQMAcAQFzBATMERAwR0DAHAEBcwQEzC0MKOmN1lkAgajWuQF1vqZoUTIZQPO2mIDWC2jkM6tHC2jsM6vHCmj0E4fHCmj0M6u9UeygNB8gvsoYCT+zmp/iHC7Nc5ur0rwhohloEUBr6pR7dU+DYFIhqA7TshMQARHQrNkJiIAIaNbsBERA+QNaswgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgJYApIJmfLdi6/BqD8G8WqHVRuSrUae9N20BQNtbQaDy1FMuLVf7CQXzGguB+7y1+GmRt1dP0uNGLfE5GHSl4yH8q6CH8mqpdbM8v2nrS7ycOYGG3QQD8OfVqs5/8AJ6fDVtqRapxQANv6VUNwEt+hB4w6kw4O+D6tN/X6MeDGkpQJ6AGe0bIQ/x55WSB5EfUCWDKSe+3XIhQHWgj0aAfHmlwmtm6WVF51h0LLW8PjDiEAsFa6nsAUDKru7nnqt5AVV6ElN524g7aX9eY1/KQ0CDn9ZVL+FBgXXR0DAfXADcyO9BOur04A+xx03AB8BEMZjXKDCTll3UxIe5FwBkjgMPhSp4qhHOqxU61ajhiQoST1aBCAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAWBdRE6qAXnbTDGcxy8sEM7VhivcbRRfN274l6GUBIPUBVMIzOCRFpwoHqJMtArQNQ2OPcIKMmHAh43UgtBejpu/fF6T82329UOIps8OPmLzIEVcbCqzAnG6gi42HeS0ClDh2T28pGP776cTMcy+KGqe2dLclKdIsBuha1fdyIhsuYKA1IBdGLZsmmyRfZq5j4Un0RP0mPkFGYclv5vyB507zvXmJt4obcQMfytxY1CJ4dp+UAXdl4McFDA7IpwgP0USJapL2hPLlTfaz8JrZtZx7wCidUVu2JnXpl9bToTaPlAN3YGouWaEA2RXzoX8Sn9gPT2LooDKB25p7tgVhiZWbie6u1lgWkjgXx6QEkkqsGkOiLRKelAOmtXvlCqgdiiVWOFQKK8KDm58aD2oDcPqgfS6w2XiMg0430AHX6INE5K1J10e2DhiI2nWHe7ASZe419kJzR6Ua7gPajWKU20aTEpPiqNYqZzH05E0UFqjS8p1d8YUDfb5q5jQuoPw9S8cGlPhzVPMhmHpCJJdbPrZQ29H5V86BpaoDGZpqudQCS0+NoQCs8F3u+xHlVLKA1ns2vUQQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBA/wcXvnyZ4yxZsgAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">hist</span>(<span class="kw">rbimodal</span>(<span class="dt">p =</span> <span class="fl">0.45</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">hist</span>(<span class="kw">rbimodal</span>(<span class="dt">p =</span> <span class="fl">0.4</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">hist</span>(<span class="kw">rbimodal</span>(<span class="dt">p =</span> <span class="fl">0.25</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">hist</span>(<span class="kw">rbimodal</span>(<span class="dt">p =</span> <span class="fl">0.1</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>观察图可知，<span class="math inline">\(p_1=0.6,0.55,0.5,0.45,0.4\)</span>时可认为分布是双峰的，其余双峰特征未能显示。</p>
<p>由此可推测：当<span class="math inline">\(p_1\)</span>接近0.5时，分布是接近双峰的</p>
</div>
<div id="compound-poisson-process" class="section level2">
<h2>3.20:Compound Poisson process</h2>
<p>根据<span class="math inline">\(N(t)\sim Poisson(\lambda t),Y_i\sim Gamma(a,b),i.i.d,X(t)=\sum_{i=1}^{N(t)}Y_i\)</span>，得到的模拟产生混合泊松-伽马过程的方式如下：</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">rCompoundPoisson&lt;-<span class="cf">function</span>(t,<span class="dt">n=</span><span class="dv">1</span>,<span class="dt">lambda=</span><span class="dv">1</span>,<span class="dt">a=</span><span class="dv">1</span>,<span class="dt">b=</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb19-2" title="2">  Nt&lt;-<span class="kw">rpois</span>(n,lambda<span class="op">*</span>t)</a>
<a class="sourceLine" id="cb19-3" title="3">  X&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,n)</a>
<a class="sourceLine" id="cb19-4" title="4">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb19-5" title="5">    X[i]&lt;-<span class="kw">sum</span>(<span class="kw">rgamma</span>(Nt[i],a,b))</a>
<a class="sourceLine" id="cb19-6" title="6">  }</a>
<a class="sourceLine" id="cb19-7" title="7">  <span class="kw">return</span>(X)</a>
<a class="sourceLine" id="cb19-8" title="8">}</a></code></pre></div>
<p>不同参数对应<span class="math inline">\(X(10)\)</span>的模拟均值、方差与理论值的对比</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="co">#设定参数</span></a>
<a class="sourceLine" id="cb20-2" title="2">para&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">ncol=</span><span class="dv">3</span>,<span class="dt">nrow=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb20-3" title="3"><span class="kw">colnames</span>(para)=<span class="kw">c</span>(<span class="st">&quot;lambda&quot;</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>)</a>
<a class="sourceLine" id="cb20-4" title="4">para[,<span class="dv">1</span>]&lt;-<span class="kw">c</span>(<span class="kw">rep</span>(<span class="fl">0.5</span>,<span class="dv">4</span>),<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>),<span class="kw">rep</span>(<span class="dv">2</span>,<span class="dv">4</span>),<span class="kw">rep</span>(<span class="dv">6</span>,<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb20-5" title="5">para[,<span class="dv">2</span>]&lt;-<span class="kw">rep</span>(<span class="kw">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb20-6" title="6">para[,<span class="dv">3</span>]&lt;-<span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb20-7" title="7"><span class="co">#理论值</span></a>
<a class="sourceLine" id="cb20-8" title="8">t&lt;-<span class="dv">10</span></a>
<a class="sourceLine" id="cb20-9" title="9">theo&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">nrow=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb20-10" title="10"><span class="kw">colnames</span>(theo)=<span class="kw">c</span>(<span class="st">&quot;theo-mean&quot;</span>,<span class="st">&quot;theo-var&quot;</span>)</a>
<a class="sourceLine" id="cb20-11" title="11">EY&lt;-para[,<span class="dv">2</span>]<span class="op">/</span>para[,<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb20-12" title="12">EY2&lt;-EY<span class="op">^</span><span class="dv">2</span><span class="op">+</span>para[,<span class="dv">2</span>]<span class="op">/</span>(para[,<span class="dv">3</span>]<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb20-13" title="13">theo[,<span class="dv">1</span>]&lt;-para[,<span class="dv">1</span>]<span class="op">*</span>t<span class="op">*</span>EY</a>
<a class="sourceLine" id="cb20-14" title="14">theo[,<span class="dv">2</span>]&lt;-para[,<span class="dv">1</span>]<span class="op">*</span>t<span class="op">*</span>EY2</a>
<a class="sourceLine" id="cb20-15" title="15"><span class="co">#模拟值</span></a>
<a class="sourceLine" id="cb20-16" title="16">est&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">nrow=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb20-17" title="17"><span class="kw">colnames</span>(est)=<span class="kw">c</span>(<span class="st">&quot;est-mean&quot;</span>,<span class="st">&quot;est-var&quot;</span>)</a>
<a class="sourceLine" id="cb20-18" title="18"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">16</span>) {</a>
<a class="sourceLine" id="cb20-19" title="19">  x&lt;-<span class="kw">rCompoundPoisson</span>(<span class="dt">t=</span><span class="dv">10</span>,<span class="dt">n=</span><span class="dv">1000</span>,para[k,<span class="dv">1</span>],para[k,<span class="dv">2</span>],para[k,<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb20-20" title="20">  est[k,<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb20-21" title="21">  est[k,<span class="dv">2</span>]&lt;-<span class="kw">var</span>(x)</a>
<a class="sourceLine" id="cb20-22" title="22">}</a>
<a class="sourceLine" id="cb20-23" title="23"><span class="co">#输出结果</span></a>
<a class="sourceLine" id="cb20-24" title="24">res&lt;-<span class="kw">cbind</span>(para,est,theo)</a>
<a class="sourceLine" id="cb20-25" title="25"><span class="co">#print(res)</span></a>
<a class="sourceLine" id="cb20-26" title="26">knitr<span class="op">::</span><span class="kw">kable</span>(res)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">lambda</th>
<th align="right">a</th>
<th align="right">b</th>
<th align="right">est-mean</th>
<th align="right">est-var</th>
<th align="right">theo-mean</th>
<th align="right">theo-var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.5</td>
<td align="right">0.5</td>
<td align="right">3</td>
<td align="right">0.8264205</td>
<td align="right">0.4251222</td>
<td align="right">0.8333333</td>
<td align="right">0.4166667</td>
</tr>
<tr class="even">
<td align="right">0.5</td>
<td align="right">1.0</td>
<td align="right">3</td>
<td align="right">1.6310663</td>
<td align="right">1.1203981</td>
<td align="right">1.6666667</td>
<td align="right">1.1111111</td>
</tr>
<tr class="odd">
<td align="right">0.5</td>
<td align="right">1.0</td>
<td align="right">1</td>
<td align="right">4.9244054</td>
<td align="right">8.7785099</td>
<td align="right">5.0000000</td>
<td align="right">10.0000000</td>
</tr>
<tr class="even">
<td align="right">0.5</td>
<td align="right">3.0</td>
<td align="right">1</td>
<td align="right">14.7173811</td>
<td align="right">57.8927352</td>
<td align="right">15.0000000</td>
<td align="right">60.0000000</td>
</tr>
<tr class="odd">
<td align="right">1.0</td>
<td align="right">0.5</td>
<td align="right">3</td>
<td align="right">1.7000787</td>
<td align="right">0.8508501</td>
<td align="right">1.6666667</td>
<td align="right">0.8333333</td>
</tr>
<tr class="even">
<td align="right">1.0</td>
<td align="right">1.0</td>
<td align="right">3</td>
<td align="right">3.3443278</td>
<td align="right">2.1480201</td>
<td align="right">3.3333333</td>
<td align="right">2.2222222</td>
</tr>
<tr class="odd">
<td align="right">1.0</td>
<td align="right">1.0</td>
<td align="right">1</td>
<td align="right">9.7888402</td>
<td align="right">19.6023848</td>
<td align="right">10.0000000</td>
<td align="right">20.0000000</td>
</tr>
<tr class="even">
<td align="right">1.0</td>
<td align="right">3.0</td>
<td align="right">1</td>
<td align="right">29.5937574</td>
<td align="right">109.3656682</td>
<td align="right">30.0000000</td>
<td align="right">120.0000000</td>
</tr>
<tr class="odd">
<td align="right">2.0</td>
<td align="right">0.5</td>
<td align="right">3</td>
<td align="right">3.3059683</td>
<td align="right">1.6502224</td>
<td align="right">3.3333333</td>
<td align="right">1.6666667</td>
</tr>
<tr class="even">
<td align="right">2.0</td>
<td align="right">1.0</td>
<td align="right">3</td>
<td align="right">6.6551014</td>
<td align="right">4.5291325</td>
<td align="right">6.6666667</td>
<td align="right">4.4444444</td>
</tr>
<tr class="odd">
<td align="right">2.0</td>
<td align="right">1.0</td>
<td align="right">1</td>
<td align="right">19.8138668</td>
<td align="right">40.4536421</td>
<td align="right">20.0000000</td>
<td align="right">40.0000000</td>
</tr>
<tr class="even">
<td align="right">2.0</td>
<td align="right">3.0</td>
<td align="right">1</td>
<td align="right">59.1264955</td>
<td align="right">223.3521656</td>
<td align="right">60.0000000</td>
<td align="right">240.0000000</td>
</tr>
<tr class="odd">
<td align="right">6.0</td>
<td align="right">0.5</td>
<td align="right">3</td>
<td align="right">10.1201241</td>
<td align="right">5.1485971</td>
<td align="right">10.0000000</td>
<td align="right">5.0000000</td>
</tr>
<tr class="even">
<td align="right">6.0</td>
<td align="right">1.0</td>
<td align="right">3</td>
<td align="right">20.0353147</td>
<td align="right">13.0531204</td>
<td align="right">20.0000000</td>
<td align="right">13.3333333</td>
</tr>
<tr class="odd">
<td align="right">6.0</td>
<td align="right">1.0</td>
<td align="right">1</td>
<td align="right">59.5962861</td>
<td align="right">119.1053218</td>
<td align="right">60.0000000</td>
<td align="right">120.0000000</td>
</tr>
<tr class="even">
<td align="right">6.0</td>
<td align="right">3.0</td>
<td align="right">1</td>
<td align="right">179.6840153</td>
<td align="right">693.7987814</td>
<td align="right">180.0000000</td>
<td align="right">720.0000000</td>
</tr>
</tbody>
</table>
<p>对比表格可知，模拟值与理论值较为接近</p>
</div>
</div>
<div id="question-2" class="section level1">
<h1>Question</h1>
<p>Exercises 5.4, 5.9, 5.13, and 5.14 (pages 149-151, Statistical Computating with R).</p>
</div>
<div id="answer-2" class="section level1">
<h1>Answer</h1>
<div id="beta33" class="section level2">
<h2>5.4 Beta(3,3)</h2>
<p><span class="math inline">\(Beta(\alpha,\beta)\)</span>的cdf：<span class="math inline">\(\phi(x)=\int^x_0\frac{t^{\alpha-1}(1-t)^{\beta-1}}{Beta(\alpha,\beta)}dt\)</span>，故题中<span class="math inline">\(Beta(3,3)\)</span>的cdf只要计算<span class="math inline">\(\theta=\int^x_0t^2(1-t)^2dt\)</span>。</p>
<p>令<span class="math inline">\(y=t/x\)</span>，则<span class="math inline">\(dt=xdy\)</span>，且<span class="math inline">\(\theta=\int^1_0x^3y^2(1-xy)^2dy=E_Y[x^3Y^2(1-xY)^2]\)</span>，其中<span class="math inline">\(Y\sim U(0,1)\)</span>。</p>
<p>生成U(0,1)分布的iid：<span class="math inline">\(u_1,u_2,\dots,u_m\)</span>，故有<span class="math inline">\(\hat{\theta}=\overline{g_m(x)}=\frac{1}{m}\sum_{i=1}^m x^3u_i^2(1-xu_i)^2\)</span>，并可由此得到<span class="math inline">\(\phi(x)\)</span>。</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">x&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb21-2" title="2">m&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb21-3" title="3">u&lt;-<span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb21-4" title="4">cdf&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb21-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)) {</a>
<a class="sourceLine" id="cb21-6" title="6">  g&lt;-x[i]<span class="op">^</span><span class="dv">3</span><span class="op">*</span>u<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[i]<span class="op">*</span>u)<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb21-7" title="7">  cdf[i]&lt;-<span class="kw">mean</span>(g)<span class="op">/</span><span class="kw">beta</span>(<span class="dv">3</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb21-8" title="8">}</a>
<a class="sourceLine" id="cb21-9" title="9">Phi&lt;-<span class="kw">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb21-10" title="10"><span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">rbind</span>(x,cdf,Phi),<span class="dv">3</span>))</a></code></pre></div>
<pre><code>##     [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11]
## x      0 0.100 0.200 0.300 0.400 0.500 0.600 0.700 0.800 0.900  1.00
## cdf    0 0.008 0.057 0.160 0.312 0.493 0.676 0.833 0.942 0.997  1.01
## Phi    0 0.009 0.058 0.163 0.317 0.500 0.683 0.837 0.942 0.991  1.00</code></pre>
<p>由对比可知，该函数生成的估计值与理论值较为接近。</p>
</div>
<div id="antithetic-variables" class="section level2">
<h2>5.9 Antithetic variables</h2>
<p>由<span class="math inline">\(f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)},x\ge0,\sigma&gt;0\)</span>可知分布函数<span class="math inline">\(F(x)=\int_{-\infty}^xf(t)dt=\int_0^x\frac{t}{\sigma^2}e^{-t^2/(2\sigma^2)}dt=1-e^{-x^2/(2\sigma^2)},x\ge0,\sigma&gt;0\)</span>，且分布函数单调递增。</p>
<p>则对符合均匀分布<span class="math inline">\(U(0,1)\)</span>的随机变量<span class="math inline">\(U\)</span>，<span class="math inline">\(X=F^{-1}(U),X&#39;=F^{-1}(1-U)\)</span>为负相关的变量。</p>
<p>以下为以此生成随机数的函数：</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">rRayleigh&lt;-<span class="cf">function</span>(<span class="dt">n=</span><span class="dv">1000</span>,<span class="dt">sigma=</span><span class="dv">1</span>,<span class="dt">anti=</span> <span class="ot">TRUE</span>){</a>
<a class="sourceLine" id="cb23-2" title="2">  u&lt;-<span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb23-3" title="3">  <span class="cf">if</span> (<span class="op">!</span>anti) v&lt;-<span class="kw">runif</span>(n) <span class="cf">else</span></a>
<a class="sourceLine" id="cb23-4" title="4">    v &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>u</a>
<a class="sourceLine" id="cb23-5" title="5">  x1&lt;-<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(u))</a>
<a class="sourceLine" id="cb23-6" title="6">  x2&lt;-<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(v))</a>
<a class="sourceLine" id="cb23-7" title="7">  x&lt;-(x1<span class="op">+</span>x2)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb23-8" title="8">  <span class="kw">return</span>(x)</a>
<a class="sourceLine" id="cb23-9" title="9">}</a></code></pre></div>
<p>方差比较：</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">K&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="co"># 对偶变量的方差</span></a>
<a class="sourceLine" id="cb24-3" title="3">sd_an&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb24-4" title="4"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>K) {</a>
<a class="sourceLine" id="cb24-5" title="5">  sd_an&lt;-sd_an<span class="op">+</span><span class="kw">var</span>(<span class="kw">rRayleigh</span>(<span class="dt">anti=</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb24-6" title="6">}</a>
<a class="sourceLine" id="cb24-7" title="7">sd_an&lt;-sd_an<span class="op">/</span>K</a>
<a class="sourceLine" id="cb24-8" title="8"><span class="kw">print</span>(sd_an)</a></code></pre></div>
<pre><code>## [1] 0.01136975</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co"># 独立变量的方差</span></a>
<a class="sourceLine" id="cb26-2" title="2">sd_in&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>K) {</a>
<a class="sourceLine" id="cb26-4" title="4">  sd_in&lt;-sd_in<span class="op">+</span><span class="kw">var</span>(<span class="kw">rRayleigh</span>(<span class="dt">anti=</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb26-5" title="5">}</a>
<a class="sourceLine" id="cb26-6" title="6">sd_in&lt;-sd_in<span class="op">/</span>K</a>
<a class="sourceLine" id="cb26-7" title="7"><span class="kw">print</span>(sd_in)</a></code></pre></div>
<pre><code>## [1] 0.2145989</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co"># 对比方差减小比例</span></a>
<a class="sourceLine" id="cb28-2" title="2"><span class="kw">print</span>((sd_in<span class="op">-</span>sd_an)<span class="op">/</span>sd_in)</a></code></pre></div>
<pre><code>## [1] 0.9470186</code></pre>
</div>
<div id="importance-functions" class="section level2">
<h2>5.13 Importance functions</h2>
<p><span class="math inline">\(\hat{\theta}=\int_1^\infty\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx=\int_0^1\frac{1}{t^4\sqrt{2\pi}}e^{-1/(2t^2)}dt\)</span>，对化简后的式子（对<span class="math inline">\(h(t)=\frac{1}{t^4\sqrt{2\pi}}e^{-1/(2t^2)}\)</span>积分）进行计算。</p>
<p>取<span class="math inline">\(f_1(x)=1,-\infty&lt;x&lt;+\infty\)</span>和<span class="math inline">\(f_2(x)=(1+x^2)^{-1}/\pi,0&lt;x&lt;\infty\)</span></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">    x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">.01</span>)</a>
<a class="sourceLine" id="cb30-2" title="2">    w &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb30-3" title="3">    h &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>x<span class="op">^</span><span class="dv">4</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">/</span>x<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb30-4" title="4">    f1 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>,<span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb30-5" title="5">    f2 &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>pi) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb30-6" title="6">    gs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">h</span>(x)<span class="op">==</span><span class="dv">1</span><span class="op">/</span>(x<span class="op">^</span><span class="dv">4</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="dv">1</span>[(x<span class="op">&gt;</span><span class="dv">0</span>)]<span class="op">*</span><span class="st"> </span><span class="dv">1</span>[(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)]),</a>
<a class="sourceLine" id="cb30-7" title="7">            <span class="kw">expression</span>(f[<span class="dv">1</span>](x)<span class="op">==</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb30-8" title="8">            <span class="kw">expression</span>(f[<span class="dv">2</span>](x)<span class="op">==</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>}<span class="op">/</span>pi))</a>
<a class="sourceLine" id="cb30-9" title="9">    <span class="co">#for color change lty to col</span></a>
<a class="sourceLine" id="cb30-10" title="10">    <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb30-11" title="11">    <span class="co">#figure (a)</span></a>
<a class="sourceLine" id="cb30-12" title="12">    <span class="kw">plot</span>(x, h, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb30-13" title="13">         <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">main=</span><span class="st">&#39;(A)&#39;</span>)</a>
<a class="sourceLine" id="cb30-14" title="14">    <span class="kw">lines</span>(x, f1, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb30-15" title="15">    <span class="kw">lines</span>(x, f2, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb30-16" title="16">    <span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> gs,</a>
<a class="sourceLine" id="cb30-17" title="17">           <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">lwd =</span> w, <span class="dt">inset =</span> <span class="fl">0.02</span>,<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb30-18" title="18"></a>
<a class="sourceLine" id="cb30-19" title="19">    <span class="co">#figure (b)</span></a>
<a class="sourceLine" id="cb30-20" title="20">    <span class="kw">plot</span>(x, h<span class="op">/</span>f1, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb30-21" title="21">        <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">4.5</span>), <span class="dt">lwd =</span> w, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">main=</span><span class="st">&#39;(B)&#39;</span>)</a>
<a class="sourceLine" id="cb30-22" title="22">    <span class="kw">lines</span>(x, h<span class="op">/</span>f2, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb30-23" title="23">    <span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> gs[<span class="op">-</span><span class="dv">1</span>],</a>
<a class="sourceLine" id="cb30-24" title="24">           <span class="dt">lty =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">lwd =</span> w, <span class="dt">inset =</span> <span class="fl">0.02</span>,<span class="dt">col=</span><span class="dv">2</span><span class="op">:</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> <span class="math inline">\(f_1\)</span>的拟合的方差更小。 因为<span class="math inline">\(f_2\)</span>有大量取值接近0（如图A），使得<span class="math inline">\(g(x)/f(x)\)</span>（如图B）远离0，而且造成较大误差，因此方差较大。</p>
</div>
<div id="importance-sampling" class="section level2">
<h2>5.14 Importance sampling</h2>
<p>用<span class="math inline">\(f_1(x)=1,-\infty&lt;x&lt;+\infty\)</span>和<span class="math inline">\(f_2(x)=e^{-x},0&lt;x&lt;\infty\)</span>两函数进行估计</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb31-2" title="2">theta.hat &lt;-<span class="st"> </span>se &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb31-3" title="3">h &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb31-4" title="4">  <span class="dv">1</span><span class="op">/</span>x<span class="op">^</span><span class="dv">4</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">/</span>x<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb31-5" title="5">}</a></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="co"># f1</span></a>
<a class="sourceLine" id="cb32-2" title="2">x &lt;-<span class="st"> </span><span class="kw">runif</span>(m) </a>
<a class="sourceLine" id="cb32-3" title="3">fh &lt;-<span class="st"> </span><span class="kw">h</span>(x)</a>
<a class="sourceLine" id="cb32-4" title="4">theta.hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fh)</a>
<a class="sourceLine" id="cb32-5" title="5">se[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fh)</a>
<a class="sourceLine" id="cb32-6" title="6"><span class="co"># f2</span></a>
<a class="sourceLine" id="cb32-7" title="7">x &lt;-<span class="st"> </span><span class="kw">rexp</span>(m, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb32-8" title="8">fh &lt;-<span class="st"> </span><span class="kw">h</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x)</a>
<a class="sourceLine" id="cb32-9" title="9">theta.hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fh)</a>
<a class="sourceLine" id="cb32-10" title="10">se[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fh)</a>
<a class="sourceLine" id="cb32-11" title="11"><span class="co"># 结果</span></a>
<a class="sourceLine" id="cb32-12" title="12"><span class="kw">rbind</span>(theta.hat,se)</a></code></pre></div>
<pre><code>##                [,1]      [,2]
## theta.hat 0.4005116 0.3922008
## se        0.3048225 0.5399976</code></pre>
<p>上述结果中，theta.hat和se分别表示<span class="math inline">\(\hat{\theta}\)</span>的用<span class="math inline">\(\frac{h(X_i)}{f(X_i)}\)</span>拟合的结果和方差。</p>
</div>
</div>
<div id="question-3" class="section level1">
<h1>Question</h1>
<p>1.Exercises 6.5 and 6.A (page 180-181, Statistical Computating with R).</p>
<p>2.If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.</p>
<p>What is the corresponding hypothesis test problem?</p>
<p>What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?</p>
<p>Please provide the least necessary information for hypothesis testing.</p>
</div>
<div id="answer-3" class="section level1">
<h1>Answer</h1>
<div id="section" class="section level2">
<h2>6.5</h2>
<p><span class="math inline">\(\chi^2(2)\)</span>的理论均值为<span class="math inline">\(\mu=2\)</span></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">n&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb34-2" title="2">alpha&lt;-<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb34-3" title="3">CL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb34-4" title="4">x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb34-5" title="5"><span class="kw">c</span>(<span class="kw">mean</span>(x)<span class="op">+</span><span class="st"> </span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sqrt</span>(<span class="kw">var</span>(x))<span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n),<span class="kw">mean</span>(x)<span class="op">-</span><span class="st"> </span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sqrt</span>(<span class="kw">var</span>(x))<span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n))</a>
<a class="sourceLine" id="cb34-6" title="6">} )</a>
<a class="sourceLine" id="cb34-7" title="7"><span class="co">#compute the mean to get the confidence level</span></a>
<a class="sourceLine" id="cb34-8" title="8"><span class="kw">length</span>(<span class="kw">intersect</span>(<span class="kw">which</span>(CL[<span class="dv">1</span>,]<span class="op">&lt;</span><span class="dv">2</span>),<span class="kw">which</span>(CL[<span class="dv">2</span>,]<span class="op">&gt;</span><span class="dv">2</span>)))<span class="op">/</span><span class="dv">1000</span></a></code></pre></div>
<pre><code>## [1] 0.905</code></pre>
<p>Example6.4中的方差在置信区间中的概率（理论值）为0.95，说明该要求更低，故上述蒙特卡洛方法更稳健。</p>
</div>
<div id="a" class="section level2">
<h2>6.A</h2>
<p><span class="math inline">\(\chi^2(1),U(0,1),Exp(1)\)</span>的均值（理论值）均为<span class="math inline">\(\mu_0=1\)</span>，一下分别计算其I型错误概率</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb36-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb36-3" title="3">mu0 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb36-4" title="4">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb36-5" title="5">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#storage for p-values</span></a></code></pre></div>
<p><span class="math inline">\(\chi^2(1)\)</span></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb37-2" title="2">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb37-3" title="3">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>, <span class="dt">mu =</span> mu0)</a>
<a class="sourceLine" id="cb37-4" title="4">  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb37-5" title="5">}</a>
<a class="sourceLine" id="cb37-6" title="6">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb37-7" title="7">se.hat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(p.hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p.hat) <span class="op">/</span><span class="st"> </span>m)</a>
<a class="sourceLine" id="cb37-8" title="8"><span class="kw">print</span>(<span class="kw">c</span>(p.hat, se.hat))</a></code></pre></div>
<pre><code>## [1] 0.013700000 0.001162425</code></pre>
<p><span class="math inline">\(U(0,1)\)</span></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb39-2" title="2">  x &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb39-3" title="3">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>, <span class="dt">mu =</span> mu0)</a>
<a class="sourceLine" id="cb39-4" title="4">  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb39-5" title="5">}</a>
<a class="sourceLine" id="cb39-6" title="6">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb39-7" title="7">se.hat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(p.hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p.hat) <span class="op">/</span><span class="st"> </span>m)</a>
<a class="sourceLine" id="cb39-8" title="8"><span class="kw">print</span>(<span class="kw">c</span>(p.hat, se.hat))</a></code></pre></div>
<pre><code>## [1] 0.050800000 0.002195891</code></pre>
<p><span class="math inline">\(Exp(1)\)</span></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb41-2" title="2">  x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb41-3" title="3">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>, <span class="dt">mu =</span> mu0)</a>
<a class="sourceLine" id="cb41-4" title="4">  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb41-5" title="5">}</a>
<a class="sourceLine" id="cb41-6" title="6">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb41-7" title="7">se.hat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(p.hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p.hat) <span class="op">/</span><span class="st"> </span>m)</a>
<a class="sourceLine" id="cb41-8" title="8"><span class="kw">print</span>(<span class="kw">c</span>(p.hat, se.hat))</a></code></pre></div>
<pre><code>## [1] 0.018800000 0.001358181</code></pre>
</div>
<div id="section-1" class="section level2">
<h2>2</h2>
<p>记两次的power分别为<span class="math inline">\(p_1,p_2\)</span>，则假设检验的问题是：<span class="math inline">\(H_0:p_1=p_2,H_1:p_1\neq p_2\)</span>。</p>
<p>应该使用McNemar检验。Z检验常用于大样本的平均值差异性检验，用标准正态分布的理论来推断差异发生的概率，从而比较两个平均数的差异是否显著。t检验主要用于样本含量较小），总体标准差未知的正态分布资料,两样本t检验和配对t检验则是根据样本情况和假设检验本身进行选择。McNemar检验用于比较两个模型的差异性，检验统计量是原假设发生的概率，具有卡方分布t特征。</p>
<p>必要信息：二分类形式的变量，所有研究对象均有前后两次数据测量</p>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Exercises 6.C (pages 182, Statistical Computing with R).</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div id="c" class="section level3">
<h3>6.C</h3>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia[187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[\beta_{1,d}=E[(X-\mu)^T\Sigma^{-1}(Y-u)]^3.\]</span> Under normality, <span class="math inline">\(\beta_{1,d}=0\)</span>. The multivariate skewness statistic is <span class="math display">\[b_{1,d}=\frac{1}{n^2}\sum_{i,j=1}^n((X_i-\bar X)^T\hat \Sigma^{-1}(X_j-\bar X))^3, \tag{6.5}\]</span> where <span class="math inline">\(\hat \Sigma\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d+1)(d+2)/6\)</span> degrees of freedom.</p>
<p><strong>多元正态性的偏度检验(6.8)：</strong><br />
假设为 <span class="math display">\[H_0:\beta_{1,d}=0 \leftrightarrow H_1:\beta_{1,d}\neq 0\]</span> 当多元总体为正态时，<span class="math inline">\(\frac{nb_{1,d}}{6}\)</span>的渐进分布为<span class="math inline">\(\chi_{d(d+1)(d+2)/6}^2\)</span>，对大的<span class="math inline">\(|\beta_{1,d}|\)</span>值拒绝原假设。<br />
对大小为<span class="math inline">\(n=10,20,30,50,100,500\)</span>的样本，估计基于<span class="math inline">\(\frac{nb_{1,d}}{6}\)</span>的渐进分布的多元正态性偏度检验在显著水平<span class="math inline">\(\alpha=0.05\)</span>下的第一类错误率，在正态极限分布下计算临界值向量并存储到<span class="math inline">\(b_0\)</span>中。并给出<em>mul.sk()</em>函数用来计算样本多元偏度统计量。</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">nn &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>)  <span class="co"># 样本容量</span></a>
<a class="sourceLine" id="cb43-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>                 <span class="co"># 显著性水平</span></a>
<a class="sourceLine" id="cb43-3" title="3">d &lt;-<span class="st"> </span><span class="dv">2</span>                        <span class="co"># 随机变量的维数</span></a>
<a class="sourceLine" id="cb43-4" title="4">b0 &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>alpha,<span class="dt">df=</span>d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)<span class="op">*</span><span class="dv">6</span><span class="op">/</span>nn  <span class="co"># 每种样本容量临界值向量</span></a>
<a class="sourceLine" id="cb43-5" title="5"></a>
<a class="sourceLine" id="cb43-6" title="6"><span class="co"># 计算多元样本偏度统计量</span></a>
<a class="sourceLine" id="cb43-7" title="7">mul.sk &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb43-8" title="8">  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x) <span class="co"># 样本个数</span></a>
<a class="sourceLine" id="cb43-9" title="9">  xbar &lt;-<span class="st"> </span><span class="kw">colMeans</span>(x) </a>
<a class="sourceLine" id="cb43-10" title="10">  sigma.hat &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">/</span>n<span class="op">*</span><span class="kw">cov</span>(x) <span class="co"># MLE估计</span></a>
<a class="sourceLine" id="cb43-11" title="11">  </a>
<a class="sourceLine" id="cb43-12" title="12">  b &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb43-13" title="13">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(x)){</a>
<a class="sourceLine" id="cb43-14" title="14">    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(x)){</a>
<a class="sourceLine" id="cb43-15" title="15">      b &lt;-<span class="st"> </span>b<span class="op">+</span>((x[i,]<span class="op">-</span>xbar)<span class="op">%*%</span><span class="kw">solve</span>(sigma.hat)<span class="op">%*%</span>(x[j,]<span class="op">-</span>xbar))<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb43-16" title="16">    }</a>
<a class="sourceLine" id="cb43-17" title="17">  }</a>
<a class="sourceLine" id="cb43-18" title="18">  <span class="kw">return</span>(b<span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb43-19" title="19">}</a>
<a class="sourceLine" id="cb43-20" title="20"></a>
<a class="sourceLine" id="cb43-21" title="21"><span class="co"># 计算第一类错误的经验估计</span></a>
<a class="sourceLine" id="cb43-22" title="22"><span class="kw">library</span>(mvtnorm)</a>
<a class="sourceLine" id="cb43-23" title="23"><span class="kw">set.seed</span>(<span class="dv">200</span>)</a>
<a class="sourceLine" id="cb43-24" title="24">p.reject &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode =</span> <span class="st">&quot;numeric&quot;</span>,<span class="dt">length =</span> <span class="kw">length</span>(nn)) <span class="co"># 保存模拟结果</span></a>
<a class="sourceLine" id="cb43-25" title="25"></a>
<a class="sourceLine" id="cb43-26" title="26">m &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb43-27" title="27"></a>
<a class="sourceLine" id="cb43-28" title="28"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(nn)){</a>
<a class="sourceLine" id="cb43-29" title="29">  mul.sktests &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode =</span> <span class="st">&quot;numeric&quot;</span>,<span class="dt">length =</span> m)</a>
<a class="sourceLine" id="cb43-30" title="30">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb43-31" title="31">    data &lt;-<span class="st"> </span><span class="kw">rmvnorm</span>(nn[i],<span class="dt">mean =</span> <span class="kw">rep</span>(<span class="dv">0</span>,d))</a>
<a class="sourceLine" id="cb43-32" title="32">    mul.sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">mul.sk</span>(data)<span class="op">&gt;</span>b0[i])</a>
<a class="sourceLine" id="cb43-33" title="33">  }</a>
<a class="sourceLine" id="cb43-34" title="34">  p.reject[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(mul.sktests)</a>
<a class="sourceLine" id="cb43-35" title="35">}</a>
<a class="sourceLine" id="cb43-36" title="36">p.reject</a></code></pre></div>
<pre><code>## [1] 0.00 0.03 0.04 0.03 0.01 0.03</code></pre>
<p>模拟结果为第一类错误的经验估计，总结如下:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">summ &lt;-<span class="st"> </span><span class="kw">rbind</span>(nn,p.reject)</a>
<a class="sourceLine" id="cb45-2" title="2"><span class="kw">rownames</span>(summ) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;n&quot;</span>,<span class="st">&quot;estimate&quot;</span>)</a>
<a class="sourceLine" id="cb45-3" title="3">knitr<span class="op">::</span><span class="kw">kable</span>(summ)</a></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">n</td>
<td align="right">10</td>
<td align="right">20.00</td>
<td align="right">30.00</td>
<td align="right">50.00</td>
<td align="right">1e+02</td>
<td align="right">5e+02</td>
</tr>
<tr class="even">
<td align="left">estimate</td>
<td align="right">0</td>
<td align="right">0.03</td>
<td align="right">0.04</td>
<td align="right">0.03</td>
<td align="right">1e-02</td>
<td align="right">3e-02</td>
</tr>
</tbody>
</table>
<p>模拟的结果说明渐进卡方分布对大小<span class="math inline">\(n\leq 50\)</span>的小样本并不合适，需要进一步求方差的精确值。</p>
<p><br />
<strong>多元正态性偏度检验的功效(6.10)</strong><br />
类似例6.10，针对污染正态备择假设，通过模拟估计多元正态性偏度检验的功效，污染正态分布表示如下： <span class="math display">\[(1-\epsilon)N(0,I_d)+\epsilon N(0,100I_d),0 \leq \epsilon \leq 1\]</span> 对一列以<span class="math inline">\(\epsilon\)</span>为指标的备择假设估计其多元偏度检验的功效，并绘制检验功效的功效函数。显著性水平<span class="math inline">\(\alpha=0.1\)</span>，样本大小为<span class="math inline">\(n=30\)</span>。</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb46-2" title="2">n &lt;-<span class="st"> </span><span class="dv">30</span>      <span class="co"># 样本大小</span></a>
<a class="sourceLine" id="cb46-3" title="3">m &lt;-<span class="st"> </span><span class="dv">200</span>   <span class="co"># 重复次数</span></a>
<a class="sourceLine" id="cb46-4" title="4">epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="fl">0.15</span>,<span class="fl">0.01</span>),<span class="kw">seq</span>(<span class="fl">0.15</span>,<span class="dv">1</span>,<span class="fl">0.05</span>))</a>
<a class="sourceLine" id="cb46-5" title="5">N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</a>
<a class="sourceLine" id="cb46-6" title="6">power &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode =</span> <span class="st">&quot;numeric&quot;</span>,<span class="dt">length =</span> N)</a>
<a class="sourceLine" id="cb46-7" title="7">b0 &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>alpha,<span class="dt">df=</span>d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)<span class="op">*</span><span class="dv">6</span><span class="op">/</span>n  <span class="co">#临界值</span></a>
<a class="sourceLine" id="cb46-8" title="8"></a>
<a class="sourceLine" id="cb46-9" title="9"><span class="co"># 对这列epsilon分别求power</span></a>
<a class="sourceLine" id="cb46-10" title="10"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb46-11" title="11">  e &lt;-<span class="st"> </span>epsilon[j]</a>
<a class="sourceLine" id="cb46-12" title="12">  mul.sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb46-13" title="13">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb46-14" title="14">    <span class="co"># 生成混合分布</span></a>
<a class="sourceLine" id="cb46-15" title="15">    u &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="dt">size =</span> n,<span class="dt">replace =</span> T,<span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e,e))</a>
<a class="sourceLine" id="cb46-16" title="16">    data1 &lt;-<span class="st"> </span><span class="kw">rmvnorm</span>(n,<span class="dt">sigma =</span> <span class="kw">diag</span>(<span class="dv">1</span>,d))</a>
<a class="sourceLine" id="cb46-17" title="17">    data2 &lt;-<span class="st"> </span><span class="kw">rmvnorm</span>(n,<span class="dt">sigma =</span> <span class="kw">diag</span>(<span class="dv">100</span>,d))</a>
<a class="sourceLine" id="cb46-18" title="18">    data &lt;-<span class="st"> </span>u<span class="op">*</span>data1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">*</span>data2</a>
<a class="sourceLine" id="cb46-19" title="19">    mul.sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">mul.sk</span>(data)<span class="op">&gt;</span>b0)</a>
<a class="sourceLine" id="cb46-20" title="20">  }</a>
<a class="sourceLine" id="cb46-21" title="21">  power[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(mul.sktests)</a>
<a class="sourceLine" id="cb46-22" title="22">}</a>
<a class="sourceLine" id="cb46-23" title="23"></a>
<a class="sourceLine" id="cb46-24" title="24"><span class="co"># 绘制功效函数</span></a>
<a class="sourceLine" id="cb46-25" title="25"><span class="kw">plot</span>(epsilon,power,<span class="dt">type=</span><span class="st">&quot;b&quot;</span>,<span class="dt">xlab=</span><span class="kw">bquote</span>(epsilon),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb46-26" title="26"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">0.1</span>,<span class="dt">lty=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">&quot;lightblue&quot;</span>)</a>
<a class="sourceLine" id="cb46-27" title="27">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(power<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>power)<span class="op">/</span>m)  <span class="co"># 绘制标准误差</span></a>
<a class="sourceLine" id="cb46-28" title="28"><span class="kw">lines</span>(epsilon,power<span class="op">-</span>se,<span class="dt">lty=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb46-29" title="29"><span class="kw">lines</span>(epsilon,power<span class="op">+</span>se,<span class="dt">lty=</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>从图中可以看出，功效函数在两个端点<span class="math inline">\(\epsilon=0\)</span>和<span class="math inline">\(\epsilon=1\)</span>处与<span class="math inline">\(\alpha=0.1\)</span>对应的水平线相较，对于<span class="math inline">\(0&lt;\epsilon&lt;1\)</span>，经验功效函数要大于0.1，且在0.15左右达到最高。</p>
</div>
</div>
</div>
<div id="question-5" class="section level1">
<h1>Question</h1>
<p>Exercises 7.7,7.8,7.9 and 7.B (pages 213, Statistical Computating with R)</p>
</div>
<div id="answer-5" class="section level1">
<h1>Answer</h1>
<div id="section-2" class="section level2">
<h2>7.7</h2>
<p>sample estimate of <span class="math inline">\(\hat{\theta}\)</span></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb47-2" title="2"><span class="kw">data</span>(<span class="st">&quot;scor&quot;</span>,<span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</a>
<a class="sourceLine" id="cb47-3" title="3">n&lt;-<span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb47-4" title="4">lam.hat&lt;-<span class="kw">eigen</span>(<span class="kw">cov</span>(scor))<span class="op">$</span>value</a>
<a class="sourceLine" id="cb47-5" title="5">theta.hat&lt;-lam.hat[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lam.hat)</a>
<a class="sourceLine" id="cb47-6" title="6">theta.hat</a></code></pre></div>
<pre><code>## [1] 0.619115</code></pre>
<p>Use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">B&lt;-<span class="dv">50</span></a>
<a class="sourceLine" id="cb49-2" title="2">theta.b&lt;-<span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb49-3" title="3"><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) {</a>
<a class="sourceLine" id="cb49-4" title="4">  i&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n,<span class="dt">size =</span> n,<span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb49-5" title="5">  S&lt;-<span class="kw">cov</span>(scor[i,])</a>
<a class="sourceLine" id="cb49-6" title="6">  lam&lt;-<span class="kw">eigen</span>(S)<span class="op">$</span>value</a>
<a class="sourceLine" id="cb49-7" title="7">  theta.b[i]&lt;-lam[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lam)</a>
<a class="sourceLine" id="cb49-8" title="8">}</a>
<a class="sourceLine" id="cb49-9" title="9">bias&lt;-<span class="kw">mean</span>(theta.b<span class="op">-</span>theta.hat)</a>
<a class="sourceLine" id="cb49-10" title="10">bias</a></code></pre></div>
<pre><code>## [1] -0.03244159</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">sd&lt;-<span class="kw">sd</span>(theta.b)</a>
<a class="sourceLine" id="cb51-2" title="2">sd</a></code></pre></div>
<pre><code>## [1] 0.03027344</code></pre>
</div>
<div id="section-3" class="section level2">
<h2>7.8</h2>
<p>Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1">theta.j&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb53-2" title="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb53-3" title="3">  S&lt;-<span class="kw">cov</span>(scor[<span class="op">-</span>i,])</a>
<a class="sourceLine" id="cb53-4" title="4">  lam&lt;-<span class="kw">eigen</span>(S)<span class="op">$</span>value</a>
<a class="sourceLine" id="cb53-5" title="5">  theta.j[i]&lt;-lam[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lam)</a>
<a class="sourceLine" id="cb53-6" title="6">}</a>
<a class="sourceLine" id="cb53-7" title="7">bias&lt;-(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.j)<span class="op">-</span>theta.hat)</a>
<a class="sourceLine" id="cb53-8" title="8">bias</a></code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">se&lt;-<span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.j<span class="op">-</span><span class="kw">mean</span>(theta.j))<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb55-2" title="2">se</a></code></pre></div>
<pre><code>## [1] 0.04955231</code></pre>
</div>
<div id="section-4" class="section level2">
<h2>7.9</h2>
<p>Compute 95% percentile and BCa confidence intervals for <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb57-2" title="2">theta.boot&lt;-<span class="cf">function</span>(dat,ind){</a>
<a class="sourceLine" id="cb57-3" title="3">  S&lt;-<span class="kw">cov</span>(dat[ind,])</a>
<a class="sourceLine" id="cb57-4" title="4">  lam&lt;-<span class="kw">eigen</span>(S)<span class="op">$</span>value</a>
<a class="sourceLine" id="cb57-5" title="5">  lam[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lam)</a>
<a class="sourceLine" id="cb57-6" title="6">}</a>
<a class="sourceLine" id="cb57-7" title="7">boot.obj&lt;-<span class="kw">boot</span>(scor,<span class="dt">statistic =</span> theta.boot,<span class="dt">R=</span><span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb57-8" title="8"><span class="kw">print</span>(<span class="kw">boot.ci</span>(boot.obj,<span class="dt">type =</span> <span class="st">&quot;perc&quot;</span>))</a></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = &quot;perc&quot;)
## 
## Intervals : 
## Level     Percentile     
## 95%   ( 0.5239,  0.7079 )  
## Calculations and Intervals on Original Scale</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1">boot.BCa&lt;-<span class="cf">function</span>(x,th0,th,stat,<span class="dt">conf=</span>.<span class="dv">95</span>){</a>
<a class="sourceLine" id="cb59-2" title="2">  x&lt;-<span class="kw">as.matrix</span>(x)</a>
<a class="sourceLine" id="cb59-3" title="3">  n&lt;-<span class="kw">nrow</span>(x)</a>
<a class="sourceLine" id="cb59-4" title="4">  N&lt;-<span class="dv">1</span><span class="op">:</span>n</a>
<a class="sourceLine" id="cb59-5" title="5">  alpha&lt;-(<span class="dv">1</span><span class="op">+</span><span class="kw">c</span>(<span class="op">-</span>conf,conf))<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb59-6" title="6">  zalpha&lt;-<span class="kw">qnorm</span>(alpha)</a>
<a class="sourceLine" id="cb59-7" title="7">  z0&lt;-<span class="kw">qnorm</span>(<span class="kw">sum</span>(th<span class="op">&lt;</span>th0)<span class="op">/</span><span class="kw">length</span>(th))</a>
<a class="sourceLine" id="cb59-8" title="8">  th.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb59-9" title="9">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb59-10" title="10">    J &lt;-<span class="st"> </span>N[<span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>)]</a>
<a class="sourceLine" id="cb59-11" title="11">    th.jack[i] &lt;-<span class="st"> </span><span class="kw">stat</span>(x[<span class="op">-</span>i, ], J)</a>
<a class="sourceLine" id="cb59-12" title="12">  }</a>
<a class="sourceLine" id="cb59-13" title="13">  L &lt;-<span class="st"> </span><span class="kw">mean</span>(th.jack) <span class="op">-</span><span class="st"> </span>th.jack</a>
<a class="sourceLine" id="cb59-14" title="14">  a &lt;-<span class="st"> </span><span class="kw">sum</span>(L<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>(<span class="dv">6</span> <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(L<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb59-15" title="15">  adj.alpha &lt;-<span class="st"> </span><span class="kw">pnorm</span>(z0 <span class="op">+</span><span class="st"> </span>(z0<span class="op">+</span>zalpha)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>a<span class="op">*</span>(z0<span class="op">+</span>zalpha)))</a>
<a class="sourceLine" id="cb59-16" title="16">  limits &lt;-<span class="st"> </span><span class="kw">quantile</span>(th, adj.alpha, <span class="dt">type=</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb59-17" title="17">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="st">&quot;est&quot;</span>=th0, <span class="st">&quot;BCa&quot;</span>=limits))</a>
<a class="sourceLine" id="cb59-18" title="18">}</a>
<a class="sourceLine" id="cb59-19" title="19"><span class="kw">boot.BCa</span>(scor,th0&lt;-theta.hat,<span class="dt">th=</span>theta.b,<span class="dt">stat=</span>theta.boot)</a></code></pre></div>
<pre><code>## $est
## [1] 0.619115
## 
## $BCa
## 23.71444% 99.95263% 
## 0.5713739 0.6315652</code></pre>
</div>
<div id="b" class="section level2">
<h2>7.B</h2>
<p>normal populations (skewness 0)</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb61-2" title="2">n&lt;-<span class="dv">10000</span></a>
<a class="sourceLine" id="cb61-3" title="3">x&lt;-<span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb61-4" title="4">theta.boot&lt;-<span class="cf">function</span>(dat,ind){</a>
<a class="sourceLine" id="cb61-5" title="5">  <span class="kw">mean</span>(dat[ind])</a>
<a class="sourceLine" id="cb61-6" title="6">}</a>
<a class="sourceLine" id="cb61-7" title="7">boot.obj&lt;-<span class="kw">boot</span>(x,<span class="dt">statistic =</span> theta.boot,<span class="dt">R=</span><span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb61-8" title="8">ci&lt;-<span class="kw">boot.ci</span>(boot.obj,<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb61-9" title="9"><span class="kw">print</span>(ci)</a></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;))
## 
## Intervals : 
## Level      Normal              Basic              Percentile     
## 95%   (-0.0200,  0.0203 )   (-0.0202,  0.0199 )   (-0.0196,  0.0205 )  
## Calculations and Intervals on Original Scale</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1">intervals&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow =</span> <span class="dv">3</span>,<span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb63-2" title="2">intervals[<span class="dv">1</span>,]&lt;-ci<span class="op">$</span>normal[<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb63-3" title="3">intervals[<span class="dv">2</span>,]&lt;-ci<span class="op">$</span>basic[<span class="op">-</span><span class="dv">3</span><span class="op">:-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb63-4" title="4">intervals[<span class="dv">3</span>,]&lt;-ci<span class="op">$</span>percent[<span class="op">-</span><span class="dv">3</span><span class="op">:-</span><span class="dv">1</span>]</a></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">M&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb64-2" title="2">mont.mean&lt;-<span class="kw">numeric</span>(M)</a>
<a class="sourceLine" id="cb64-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M) {</a>
<a class="sourceLine" id="cb64-4" title="4">  xm&lt;-<span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb64-5" title="5">  mont.mean[i]&lt;-<span class="kw">mean</span>(xm)</a>
<a class="sourceLine" id="cb64-6" title="6">}</a>
<a class="sourceLine" id="cb64-7" title="7">cover&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb64-8" title="8">left&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb64-9" title="9">right&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>)</a></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) {</a>
<a class="sourceLine" id="cb65-2" title="2">  left.id&lt;-<span class="kw">which</span>(mont.mean<span class="op">&lt;</span>intervals[j,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb65-3" title="3">  right.id&lt;-<span class="kw">which</span>(mont.mean<span class="op">&gt;</span>intervals[j,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb65-4" title="4">  left[j]&lt;-<span class="kw">length</span>(left.id)</a>
<a class="sourceLine" id="cb65-5" title="5">  right[j]&lt;-<span class="kw">length</span>(right.id)</a>
<a class="sourceLine" id="cb65-6" title="6">  cover[j]&lt;-M<span class="op">-</span>left[j]<span class="op">-</span>right[j]</a>
<a class="sourceLine" id="cb65-7" title="7">}</a>
<a class="sourceLine" id="cb65-8" title="8">cover<span class="op">/</span>M <span class="co"># empirical coverage rates for the sample mean</span></a></code></pre></div>
<pre><code>## [1] 0.942 0.941 0.940</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1">left<span class="op">/</span>M <span class="co">#proportion of times that the confidence intervals miss on the left</span></a></code></pre></div>
<pre><code>## [1] 0.030 0.028 0.033</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1">right<span class="op">/</span>M <span class="co">#porportion of times that the confidence intervals miss on the right</span></a></code></pre></div>
<pre><code>## [1] 0.028 0.031 0.027</code></pre>
<p><span class="math inline">\(\chi^2(5)\)</span> distributions (positive skewness)</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb71-2" title="2">n&lt;-<span class="dv">10000</span></a>
<a class="sourceLine" id="cb71-3" title="3">x&lt;-<span class="kw">rchisq</span>(n,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb71-4" title="4">theta.boot&lt;-<span class="cf">function</span>(dat,ind){</a>
<a class="sourceLine" id="cb71-5" title="5">  <span class="kw">mean</span>(dat[ind])</a>
<a class="sourceLine" id="cb71-6" title="6">}</a>
<a class="sourceLine" id="cb71-7" title="7">boot.obj&lt;-<span class="kw">boot</span>(x,<span class="dt">statistic =</span> theta.boot,<span class="dt">R=</span><span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb71-8" title="8">ci&lt;-<span class="kw">boot.ci</span>(boot.obj,<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb71-9" title="9"><span class="kw">print</span>(ci)</a></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;))
## 
## Intervals : 
## Level      Normal              Basic              Percentile     
## 95%   ( 4.881,  5.001 )   ( 4.882,  4.999 )   ( 4.884,  5.002 )  
## Calculations and Intervals on Original Scale</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1">intervals&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow =</span> <span class="dv">3</span>,<span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb73-2" title="2">intervals[<span class="dv">1</span>,]&lt;-ci<span class="op">$</span>normal[<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb73-3" title="3">intervals[<span class="dv">2</span>,]&lt;-ci<span class="op">$</span>basic[<span class="op">-</span><span class="dv">3</span><span class="op">:-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb73-4" title="4">intervals[<span class="dv">3</span>,]&lt;-ci<span class="op">$</span>percent[<span class="op">-</span><span class="dv">3</span><span class="op">:-</span><span class="dv">1</span>]</a></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1">M&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb74-2" title="2">mont.mean&lt;-<span class="kw">numeric</span>(M)</a>
<a class="sourceLine" id="cb74-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M) {</a>
<a class="sourceLine" id="cb74-4" title="4">  xm&lt;-<span class="kw">rchisq</span>(n,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb74-5" title="5">  mont.mean[i]&lt;-<span class="kw">mean</span>(xm)</a>
<a class="sourceLine" id="cb74-6" title="6">}</a>
<a class="sourceLine" id="cb74-7" title="7">cover&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb74-8" title="8">left&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb74-9" title="9">right&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>)</a></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) {</a>
<a class="sourceLine" id="cb75-2" title="2">  left.id&lt;-<span class="kw">which</span>(mont.mean<span class="op">&lt;</span>intervals[j,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb75-3" title="3">  right.id&lt;-<span class="kw">which</span>(mont.mean<span class="op">&gt;</span>intervals[j,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb75-4" title="4">  left[j]&lt;-<span class="kw">length</span>(left.id)</a>
<a class="sourceLine" id="cb75-5" title="5">  right[j]&lt;-<span class="kw">length</span>(right.id)</a>
<a class="sourceLine" id="cb75-6" title="6">  cover[j]&lt;-M<span class="op">-</span>left[j]<span class="op">-</span>right[j]</a>
<a class="sourceLine" id="cb75-7" title="7">}</a>
<a class="sourceLine" id="cb75-8" title="8">cover<span class="op">/</span>M <span class="co"># empirical coverage rates for the sample mean</span></a></code></pre></div>
<pre><code>## [1] 0.530 0.514 0.540</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1">left<span class="op">/</span>M <span class="co">#proportion of times that the confidence intervals miss on the left</span></a></code></pre></div>
<pre><code>## [1] 0.001 0.001 0.001</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1">right<span class="op">/</span>M <span class="co">#porportion of times that the confidence intervals miss on the right</span></a></code></pre></div>
<pre><code>## [1] 0.469 0.485 0.459</code></pre>
<p>The coverage rates for normal populations (skewness 0) is bigger than that for <span class="math inline">\(\chi^2(5)\)</span> distributions(positive skewness).</p>
</div>
</div>
<div id="question-6" class="section level1">
<h1>Question</h1>
<p>1.Exercise 8.2 (page 242, Statistical Computating with R).</p>
<p>2.Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<ul>
<li><p>Unequal variances and equal expectations</p></li>
<li><p>Unequal variances and unequal expectations</p></li>
<li><p>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p></li>
<li><p>Unbalanced samples (say, 1 case versus 10 controls)</p></li>
<li><p>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p></li>
</ul>
</div>
<div id="answer-6" class="section level1">
<h1>Answer</h1>
<div id="exercise-8.2" class="section level2">
<h2>Exercise 8.2</h2>
<p>Implement the bivariate Spearman rank correlation test for independence as a permutation test. The Spearman rank correlation test statistic can be obtained from function <span class="math inline">\(cor\)</span> with <span class="math inline">\(method = &quot;spearman&quot;\)</span>. Compare the achieved significance level of the permutation test with the p-value reported by cor.test on the same samples.</p>
<p>使用两组随机生成的数据</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">n&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb81-2" title="2">x&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>,n)</a>
<a class="sourceLine" id="cb81-3" title="3">y&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>,n)</a></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1">R &lt;-<span class="st"> </span><span class="dv">999</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb82-2" title="2">z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y) <span class="co">#pooled sample</span></a>
<a class="sourceLine" id="cb82-3" title="3">K &lt;-<span class="st"> </span>n<span class="op">*</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb82-4" title="4"><span class="kw">set.seed</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb82-5" title="5">reps &lt;-<span class="st"> </span><span class="kw">numeric</span>(R) <span class="co">#storage for replicates</span></a>
<a class="sourceLine" id="cb82-6" title="6">t0 &lt;-<span class="st"> </span><span class="kw">cor</span>(x,y,<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</a>
<a class="sourceLine" id="cb82-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</a>
<a class="sourceLine" id="cb82-8" title="8"><span class="co">#generate indices k for the first sample</span></a>
<a class="sourceLine" id="cb82-9" title="9">k &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb82-10" title="10">x1 &lt;-<span class="st"> </span>z[k]</a>
<a class="sourceLine" id="cb82-11" title="11">y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k] <span class="co">#complement of x1</span></a>
<a class="sourceLine" id="cb82-12" title="12">reps[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(x1, y1,<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</a>
<a class="sourceLine" id="cb82-13" title="13">}</a>
<a class="sourceLine" id="cb82-14" title="14">p &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(t0, reps)) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(t0))</a>
<a class="sourceLine" id="cb82-15" title="15"></a>
<a class="sourceLine" id="cb82-16" title="16"><span class="kw">round</span>(<span class="kw">c</span>(p,<span class="kw">cor.test</span>(x,y,<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="op">$</span>p.value),<span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 0.863 0.866</code></pre>
<p>两种方法得到的p-值较为接近。</p>
<p>通常显著性水平<span class="math inline">\(\alpha=0.05\)</span>或<span class="math inline">\(0.1\)</span>，均远小于上述两种方法得到的p-值，故拒绝原假设，与两组数据是随机生成的事实相符。</p>
<p>若两组数据相关性较高（y=2x）</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1">n&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb84-2" title="2">x&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>,n)</a>
<a class="sourceLine" id="cb84-3" title="3">y&lt;-x<span class="op">*</span><span class="dv">2</span></a></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1">R &lt;-<span class="st"> </span><span class="dv">999</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb85-2" title="2">z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y) <span class="co">#pooled sample</span></a>
<a class="sourceLine" id="cb85-3" title="3">K &lt;-<span class="st"> </span>n<span class="op">*</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb85-4" title="4"><span class="kw">set.seed</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb85-5" title="5">reps &lt;-<span class="st"> </span><span class="kw">numeric</span>(R) <span class="co">#storage for replicates</span></a>
<a class="sourceLine" id="cb85-6" title="6">t0 &lt;-<span class="st"> </span><span class="kw">cor</span>(x,y,<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</a>
<a class="sourceLine" id="cb85-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</a>
<a class="sourceLine" id="cb85-8" title="8"><span class="co">#generate indices k for the first sample</span></a>
<a class="sourceLine" id="cb85-9" title="9">k &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb85-10" title="10">x1 &lt;-<span class="st"> </span>z[k]</a>
<a class="sourceLine" id="cb85-11" title="11">y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k] <span class="co">#complement of x1</span></a>
<a class="sourceLine" id="cb85-12" title="12">reps[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(x1, y1,<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</a>
<a class="sourceLine" id="cb85-13" title="13">}</a>
<a class="sourceLine" id="cb85-14" title="14">p &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(t0, reps)) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(t0))</a>
<a class="sourceLine" id="cb85-15" title="15"></a>
<a class="sourceLine" id="cb85-16" title="16"><span class="kw">round</span>(<span class="kw">c</span>(p,<span class="kw">cor.test</span>(x,y,<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="op">$</span>p.value),<span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 0.001 0.000</code></pre>
<p>两种方法得到的p-值较为接近。</p>
<p>通常显著性水平<span class="math inline">\(\alpha=0.05\)</span>或<span class="math inline">\(0.1\)</span>，均大于上述两种方法得到的p-值，故接受原假设，与两组数据生成过程相符。</p>
</div>
<div id="designing-experiments" class="section level2">
<h2>Designing experiments</h2>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="kw">library</span>(RANN)</a>
<a class="sourceLine" id="cb87-2" title="2"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb87-3" title="3"><span class="kw">library</span>(energy)</a>
<a class="sourceLine" id="cb87-4" title="4"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb87-5" title="5">Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</a>
<a class="sourceLine" id="cb87-6" title="6">  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb87-7" title="7">  n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb87-8" title="8">  n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</a>
<a class="sourceLine" id="cb87-9" title="9">  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb87-10" title="10">  z &lt;-<span class="st"> </span>z[ix, ]</a>
<a class="sourceLine" id="cb87-11" title="11">  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) </a>
<a class="sourceLine" id="cb87-12" title="12">  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>] </a>
<a class="sourceLine" id="cb87-13" title="13">  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>] </a>
<a class="sourceLine" id="cb87-14" title="14">  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="fl">+.5</span>)</a>
<a class="sourceLine" id="cb87-15" title="15">  i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>) </a>
<a class="sourceLine" id="cb87-16" title="16">  (i1<span class="op">+</span>i2) <span class="op">/</span><span class="st"> </span>(k<span class="op">*</span>n)</a>
<a class="sourceLine" id="cb87-17" title="17">}</a>
<a class="sourceLine" id="cb87-18" title="18">eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</a>
<a class="sourceLine" id="cb87-19" title="19">  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</a>
<a class="sourceLine" id="cb87-20" title="20">  <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</a>
<a class="sourceLine" id="cb87-21" title="21">  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb87-22" title="22">  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb87-23" title="23">  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</a>
<a class="sourceLine" id="cb87-24" title="24">}</a></code></pre></div>
<ul>
<li>Unequal variances and equal expectations</li>
</ul>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1">m &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb88-2" title="2">k&lt;-<span class="dv">3</span></a>
<a class="sourceLine" id="cb88-3" title="3">R&lt;-<span class="dv">99</span></a>
<a class="sourceLine" id="cb88-4" title="4"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb88-5" title="5">n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb88-6" title="6">n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2</a>
<a class="sourceLine" id="cb88-7" title="7">N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</a></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1">p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb89-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb89-3" title="3">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb89-4" title="4">  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,<span class="dv">0</span>,<span class="fl">1.4</span>)</a>
<a class="sourceLine" id="cb89-5" title="5">  z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</a>
<a class="sourceLine" id="cb89-6" title="6">  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb89-7" title="7">  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb89-8" title="8">  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">99</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb89-9" title="9">}</a>
<a class="sourceLine" id="cb89-10" title="10">alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>; </a>
<a class="sourceLine" id="cb89-11" title="11">pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb89-12" title="12">pow</a></code></pre></div>
<pre><code>## [1] 0.288 0.503 0.709</code></pre>
<p>“ball” performs best</p>
<ul>
<li>Unequal variances and unequal expectations</li>
</ul>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1">p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb91-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb91-3" title="3">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb91-4" title="4">  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb91-5" title="5">  z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</a>
<a class="sourceLine" id="cb91-6" title="6">  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb91-7" title="7">  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb91-8" title="8">  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">99</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb91-9" title="9">}</a>
<a class="sourceLine" id="cb91-10" title="10">alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>; </a>
<a class="sourceLine" id="cb91-11" title="11">pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb91-12" title="12">pow</a></code></pre></div>
<pre><code>## [1] 0.199 0.718 0.550</code></pre>
<p>“energy” performs best</p>
<ul>
<li>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</li>
</ul>
<p>t distribution</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb93-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb93-3" title="3">  x &lt;-<span class="st"> </span><span class="kw">rt</span>(n1,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb93-4" title="4">  y &lt;-<span class="st"> </span><span class="kw">rt</span>(n2,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb93-5" title="5">  z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</a>
<a class="sourceLine" id="cb93-6" title="6">  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb93-7" title="7">  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb93-8" title="8">  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">99</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb93-9" title="9">}</a>
<a class="sourceLine" id="cb93-10" title="10">alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>; </a>
<a class="sourceLine" id="cb93-11" title="11">pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb93-12" title="12">pow</a></code></pre></div>
<pre><code>## [1] 0.194 0.630 0.508</code></pre>
<p>“energy” performs best</p>
<p>bimodel distribution</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1">p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb95-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb95-3" title="3">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="op">+</span><span class="kw">rnorm</span>(n1,<span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb95-4" title="4">  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="kw">rnorm</span>(n2,<span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb95-5" title="5">  z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</a>
<a class="sourceLine" id="cb95-6" title="6">  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb95-7" title="7">  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb95-8" title="8">  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">99</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb95-9" title="9">}</a>
<a class="sourceLine" id="cb95-10" title="10">alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>; </a>
<a class="sourceLine" id="cb95-11" title="11">pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb95-12" title="12">pow</a></code></pre></div>
<pre><code>## [1] 0.215 0.743 0.581</code></pre>
<p>“energy” performs best</p>
<ul>
<li>Unbalanced samples (say, 1 case versus 10 controls)</li>
</ul>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1">n1 &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb97-2" title="2">n2 &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb97-3" title="3">n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2</a>
<a class="sourceLine" id="cb97-4" title="4">N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</a>
<a class="sourceLine" id="cb97-5" title="5">p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb97-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb97-7" title="7">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb97-8" title="8">  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb97-9" title="9">  z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</a>
<a class="sourceLine" id="cb97-10" title="10">  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb97-11" title="11">  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb97-12" title="12">  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">99</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb97-13" title="13">}</a>
<a class="sourceLine" id="cb97-14" title="14">alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>; </a>
<a class="sourceLine" id="cb97-15" title="15">pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb97-16" title="16">pow</a></code></pre></div>
<pre><code>## [1] 0.542 0.437 0.868</code></pre>
<p>“ball” performs best</p>
</div>
</div>
<div id="question-7" class="section level1">
<h1>Question</h1>
<p>1.Exercies 9.3 and 9.8 (pages 277-278, Statistical Computating with R).</p>
<p>2.For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
</div>
<div id="answer-7" class="section level1">
<h1>Answer</h1>
<div id="exercise-9.3" class="section level2">
<h2>Exercise 9.3</h2>
<p>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see <span class="math inline">\(qcauchy\)</span> or <span class="math inline">\(qt\)</span> with df=1). Recall that a Cauchy(<span class="math inline">\(\theta, \eta\)</span>) distribution has density function <span class="math display">\[f(x)=\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)},-\infty&lt;x&lt;\infty,\theta&gt;0\]</span> The standard Cauchy has the Cauchy(<span class="math inline">\(\theta = 1, \eta = 0\)</span>) density. (Note that the standard Cauchy density is equal to the Student t density with one degree of freedom.)</p>
<p>标准柯西分布：<span class="math inline">\(f(x)=\frac{1}{\pi(1+x^2)},-\infty&lt;x&lt;\infty\)</span></p>
<p>建议分布选取正态分布<span class="math inline">\(N(X_t,1)\)</span>。</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1">f &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb99-2" title="2">  <span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span>pi<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb99-3" title="3">}</a>
<a class="sourceLine" id="cb99-4" title="4">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb99-5" title="5">f1&lt;-<span class="cf">function</span>(m){</a>
<a class="sourceLine" id="cb99-6" title="6">  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb99-7" title="7">  x[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb99-8" title="8">  k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb99-9" title="9">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb99-10" title="10">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb99-11" title="11">    xt &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb99-12" title="12">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb99-13" title="13">    num &lt;-<span class="st"> </span><span class="kw">f</span>(y) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(xt)</a>
<a class="sourceLine" id="cb99-14" title="14">    den &lt;-<span class="st"> </span><span class="kw">f</span>(xt) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(y)</a>
<a class="sourceLine" id="cb99-15" title="15">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>num<span class="op">/</span>den){</a>
<a class="sourceLine" id="cb99-16" title="16">      x[i] &lt;-<span class="st"> </span>y</a>
<a class="sourceLine" id="cb99-17" title="17">      } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb99-18" title="18">        x[i] &lt;-<span class="st"> </span>xt</a>
<a class="sourceLine" id="cb99-19" title="19">        k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span>     <span class="co">#y is rejected</span></a>
<a class="sourceLine" id="cb99-20" title="20">      }</a>
<a class="sourceLine" id="cb99-21" title="21">  }</a>
<a class="sourceLine" id="cb99-22" title="22">  <span class="kw">return</span>(x)</a>
<a class="sourceLine" id="cb99-23" title="23">}</a>
<a class="sourceLine" id="cb99-24" title="24"><span class="kw">set.seed</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb99-25" title="25">x&lt;-<span class="kw">f1</span>(m)</a></code></pre></div>
<p>选取部分生成的随机变量如图所示：</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1">index &lt;-<span class="st"> </span><span class="dv">5000</span><span class="op">:</span><span class="dv">5500</span></a>
<a class="sourceLine" id="cb100-2" title="2">y1 &lt;-<span class="st"> </span>x[index]</a>
<a class="sourceLine" id="cb100-3" title="3"><span class="kw">plot</span>(index, y1, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>比较生成观测值的十分位数和标准柯西分布的十分位数</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1">b &lt;-<span class="st"> </span><span class="dv">1001</span>      <span class="co">#discard the burn-in sample</span></a>
<a class="sourceLine" id="cb101-2" title="2">y &lt;-<span class="st"> </span>x[b<span class="op">:</span>m]</a>
<a class="sourceLine" id="cb101-3" title="3">a &lt;-<span class="st"> </span><span class="kw">ppoints</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb101-4" title="4"></a>
<a class="sourceLine" id="cb101-5" title="5">QC &lt;-<span class="st"> </span><span class="kw">qcauchy</span>(a)   <span class="co">#quantiles of Cauchy</span></a>
<a class="sourceLine" id="cb101-6" title="6">Q &lt;-<span class="st"> </span><span class="kw">quantile</span>(y, a)</a>
<a class="sourceLine" id="cb101-7" title="7"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb101-8" title="8">    <span class="kw">qqplot</span>(QC, Q, <span class="dt">main=</span><span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb101-9" title="9">        <span class="dt">xlab=</span><span class="st">&quot;Cauchy Quantiles&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</a>
<a class="sourceLine" id="cb101-10" title="10">    <span class="kw">abline</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb101-11" title="11">    <span class="kw">hist</span>(y, <span class="dt">breaks=</span><span class="st">&quot;scott&quot;</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>,<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb101-12" title="12">    <span class="kw">lines</span>(QC, <span class="kw">f</span>(QC))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Gelman-Rubin method 考查收敛性：</p>
<p>Gelman-Rubin statistic: <span class="math inline">\(\sqrt{\hat R}=\sqrt{\frac{\widehat{var}(\phi)}{W_n}}\)</span></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1">Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</a>
<a class="sourceLine" id="cb102-2" title="2">  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</a>
<a class="sourceLine" id="cb102-3" title="3">  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</a>
<a class="sourceLine" id="cb102-4" title="4">  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</a>
<a class="sourceLine" id="cb102-5" title="5">  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi)     <span class="co">#row means</span></a>
<a class="sourceLine" id="cb102-6" title="6">  B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means)        <span class="co">#between variance est.</span></a>
<a class="sourceLine" id="cb102-7" title="7">  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></a>
<a class="sourceLine" id="cb102-8" title="8">  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w)               <span class="co">#within est.</span></a>
<a class="sourceLine" id="cb102-9" title="9">  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n)     <span class="co">#upper variance est.</span></a>
<a class="sourceLine" id="cb102-10" title="10">  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W             <span class="co">#G-R statistic</span></a>
<a class="sourceLine" id="cb102-11" title="11">  <span class="kw">return</span>(r.hat)</a>
<a class="sourceLine" id="cb102-12" title="12">}</a></code></pre></div>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="co">#generate the chains</span></a>
<a class="sourceLine" id="cb103-2" title="2">m&lt;-<span class="dv">15000</span></a>
<a class="sourceLine" id="cb103-3" title="3">k&lt;-<span class="dv">4</span></a>
<a class="sourceLine" id="cb103-4" title="4">X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>m)</a>
<a class="sourceLine" id="cb103-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) {</a>
<a class="sourceLine" id="cb103-6" title="6">  <span class="kw">set.seed</span>(i<span class="op">*</span><span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb103-7" title="7">  X[i, ] &lt;-<span class="st"> </span><span class="kw">f1</span>(m)</a>
<a class="sourceLine" id="cb103-8" title="8">}</a>
<a class="sourceLine" id="cb103-9" title="9">psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</a>
<a class="sourceLine" id="cb103-10" title="10"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi)) psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</a>
<a class="sourceLine" id="cb103-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</a>
<a class="sourceLine" id="cb103-12" title="12">   <span class="cf">if</span>(i<span class="op">==</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb103-13" title="13">      <span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>(m<span class="op">-</span>b<span class="op">+</span><span class="dv">1</span>),psi[i,b<span class="op">:</span>m],<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.2</span>,<span class="fl">0.3</span>), <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="dt">ylab=</span><span class="kw">bquote</span>(phi))</a>
<a class="sourceLine" id="cb103-14" title="14">    }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb103-15" title="15">      <span class="kw">lines</span>(psi[i, b<span class="op">:</span>m], <span class="dt">col=</span>i)</a>
<a class="sourceLine" id="cb103-16" title="16">    }</a>
<a class="sourceLine" id="cb103-17" title="17">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></a></code></pre></div>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1">rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,(m<span class="op">-</span>b<span class="op">+</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb105-2" title="2"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(m<span class="op">-</span>b<span class="op">+</span><span class="dv">1</span>))  rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</a>
<a class="sourceLine" id="cb105-3" title="3"><span class="kw">plot</span>(rhat, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb105-4" title="4"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>如图大约在7000以后即可使得<span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
</div>
<div id="exercise-9.8" class="section level2">
<h2>Exercise 9.8</h2>
<p>Consider the bivariate density <span class="math display">\[f(x,y)\propto  { n \choose x }y^{x+a-1}(1-y)^{n-x+b-1},\quad x=0,1,\dots,n,0\le y\le 1.\]</span> It can be shown that for fixed <span class="math inline">\(a, b, n\)</span>, the conditional distributions are Binomial(n, y) and Beta(x + a, n − x + b). Use the Gibbs sampler to generate a chain with target joint density <span class="math inline">\(f(x, y)\)</span>.</p>
<p>取<span class="math inline">\(a=b=2,n=10\)</span>，</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1"><span class="co">#initialize constants and parameters</span></a>
<a class="sourceLine" id="cb106-2" title="2">N &lt;-<span class="st"> </span><span class="dv">5000</span> <span class="co">#length of chain</span></a>
<a class="sourceLine" id="cb106-3" title="3">burn &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#burn-in length</span></a>
<a class="sourceLine" id="cb106-4" title="4">f2&lt;-<span class="cf">function</span>(m,<span class="dt">a=</span><span class="dv">2</span>,<span class="dt">b=</span><span class="dv">2</span>,<span class="dt">n=</span><span class="dv">10</span>){</a>
<a class="sourceLine" id="cb106-5" title="5">  X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></a>
<a class="sourceLine" id="cb106-6" title="6">  <span class="co">###### generate the chain #####</span></a>
<a class="sourceLine" id="cb106-7" title="7">  X[<span class="dv">1</span>, ] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">.5</span>) <span class="co">#initialize</span></a>
<a class="sourceLine" id="cb106-8" title="8">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb106-9" title="9">    y &lt;-<span class="st"> </span>X[i<span class="dv">-1</span>, <span class="dv">2</span>]</a>
<a class="sourceLine" id="cb106-10" title="10">    X[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, n, y)</a>
<a class="sourceLine" id="cb106-11" title="11">    x &lt;-<span class="st"> </span>X[i, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb106-12" title="12">    X[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>,x<span class="op">+</span>a,n<span class="op">-</span>x<span class="op">+</span>b)</a>
<a class="sourceLine" id="cb106-13" title="13">    }</a>
<a class="sourceLine" id="cb106-14" title="14">  b &lt;-<span class="st"> </span>burn <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb106-15" title="15">  <span class="kw">return</span>(X[b<span class="op">:</span>m, ])</a>
<a class="sourceLine" id="cb106-16" title="16">}</a>
<a class="sourceLine" id="cb106-17" title="17">x&lt;-<span class="kw">f2</span>(N)</a>
<a class="sourceLine" id="cb106-18" title="18"><span class="kw">cat</span>(<span class="st">&#39;Means: &#39;</span>,<span class="kw">round</span>(<span class="kw">colMeans</span>(x),<span class="dv">2</span>))</a></code></pre></div>
<pre><code>## Means:  4.86 0.49</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1"><span class="kw">cat</span>(<span class="st">&#39;Standard errors: &#39;</span>,<span class="kw">round</span>(<span class="kw">apply</span>(x,<span class="dv">2</span>,sd),<span class="dv">2</span>))</a></code></pre></div>
<pre><code>## Standard errors:  2.69 0.23</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1"><span class="kw">cat</span>(<span class="st">&#39;Correlation coefficients: &#39;</span>, <span class="kw">round</span>(<span class="kw">cor</span>(x[,<span class="dv">1</span>],x[,<span class="dv">2</span>]),<span class="dv">2</span>))</a></code></pre></div>
<pre><code>## Correlation coefficients:  0.84</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1"><span class="kw">plot</span>(x[,<span class="dv">1</span>],<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlab=</span><span class="st">&#39;Index&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;Random numbers&#39;</span>)</a>
<a class="sourceLine" id="cb112-2" title="2"><span class="kw">lines</span>(x[,<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb112-3" title="3"><span class="kw">legend</span>(<span class="st">&#39;bottomright&#39;</span>,<span class="kw">c</span>(<span class="kw">expression</span>(x),<span class="kw">expression</span>(y)),<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1"><span class="kw">plot</span>(x,<span class="dt">xlab=</span><span class="st">&#39;x&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;y&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAVFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmZmZmtv+QOgCQZgCQ2/+2ZgC2/7a2///bkDrb/9vb////tmb/25D//7b//9v////GkoVkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHvUlEQVR4nO2dDbeiNhCGs9u7t722tbVLi8r//5/lQ1ACyTvI5Evf55z1HJY4hMfJBCTrmoZ4Mak7kDsUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAigLMgUQypBuuECcHNDQQ7G7HljQd7hM42vyIK2D+1g+NMjlaBQ4Z7pQHf+D92Yf2gUNBQY87A9M0RBVgbZA5+CLCMU5Cwyq5vvKMhVZFY330KQnTHjy7T3zQVZ1zn2tP72gox1GKcBsJuCwO5Agk7G/Lge2yP8qRLuCcCQSiyo+vivdfSjaS6HL4VwT2HXoJwEXY+tlvrb382gam+4p8g6gy6HdmTV33824+u+cM4ueb+vsA6TlaA4GbT4vmImLOsMutegXtXucJ4IdpXxb2YjKMYsthxD48tt0ysktaAI4RaC5tsUBO4lShFURZvFpGe8sXnkDDITCrEa35VgoYIUwz17e76xecGC5rNWYYL6Kb7FUYGeEzQfmEVnUGVu14e10btQXNScptgMerh+1rvVWF73lJtB/c3qgN7NqtbN1cbmBWWQ0hlvbB6qBt1SSLEGgZpTlqB2kA0HcOTPuw8xrXCPPX6tIaYTbj6vxxZ0e8lYkDWvRxY0DmgKArspaH13M25mLChxDco/gxLPYk32Rdp+R1xBBRRp+x3MoGUjXij622w5wxcRZCYkbceXx7faoVzbhQraEi7Qgy5p8ybDGjRPrEApIWye4yxmDb20gjLMIKvmpBWU462GsXbEFTQveM003rMW1DxmVOgMmh3M21FwRpdDtzJqL6tDLOSY2ZxB7o7CM6raWI7v4sUM6Tv/yNaqQIEZ1LPbkXn4M/3V/EMsN4N6OkXOJ+83zp+uFXj3K4x48/am5o8dlTFrWJtu9eH16HiqMz70MW6JryyoO/3BjOu58vi8sKgMGl+WHZXxMIv1C6D9XA6dQr+gRQ2KLKh5NKJfgxCnViMQ5L/3KjaDpFTmi4K8nD9/yXqIeZvPOipiu6BuHV45RTp6DcLhEi3XmDpgHb1ZP8fQgjwLyeOOmeX2+HJv4OioDJ0MMhPJBbnGlN1j8alJG4rDZZZB7o6Kz0gTs+ziW2WQZCH5O2eQaCF5YkEpM0i2DDitIOe8vuyojC2CZAvJIwtaXPfkn0FpLxQT1yDBQvK0Q8wIzyrQLCZZSJ5YUAnXQVEF5VSDZOFiZ1Azz5iUs5gsXNoi3bjuTpcdFZ+RJslr0IaOKjcUh4ssSFhzVjqq3FAcLnYGjS+bO6rcUByOGQTCxRUknbVWOqrcUBwusiDhrLXSUeWG4nCxBT3dUeWG4nDaguZFplBBZoIZBMMpC2q8CbWno8oNxeHCZtCzs9ZKR5UbisOpCxpf7g10OqrcUBxOW1CIbr6UILsmqXVUuaE4HAWBcBQEwu0U1NibSvP6sqPKDcXh9gqypikWaTSElC58VqLqNuwJsHjBHlIrMfUrUChBMRYvRCKIoDCLFzZ3Q4UggsIsXtjcDRUKyiD7XisOoWqQ/uIFXKSDEGgWC7B4IdAshcj4OihRyljkLChNyliEFrRhpX0eGWMTOYPMRK4ZY5NwiOWZMTYpBWWZMTYJb1bLINnNajGEECS41ZAFBfv37d779h3NBTersqCvKogZhMA3q7KgLysI36zKgr6uIKWgFLRvPwVR0L79ry/olaAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEAfUG1Mb5fhe0frfl/s/rk+cLy/Gm8v5ze/dyz81cez7/9FPRwjrqguj127T7+9djuq7znWHu+0a3bXZeD+91Vd3SXocuhfxYDemihLWh48nFynsLwO7CuxSEdl4Nb0BDd/e7r8Yf76PXwRBj10EJbEBbQ4fsAq4+/nILOv/o/eJ+g2nz1T/NkPZxQF9Sfgv+5YnsK7v1tAHcNqr//c/BWMO8QG7ol6+GEtqAhN8AQ9zxW6waAW1DVDZIhTZyhPQW4tyLq4Z0UgmpPje4e2XoEfQOffpea50+X/hwECRLY91i2f7tHUB/X/YPfoL7kMMRwCay8NeS2OMVhYDgtd6kG2ZFDkYaTaOW+jhtxZ9CwvsT96Q8n7/5fHTKY5tFlmLtA3PFcSXcl6mGRyfKtuAYlvlDsR4nvKmcYQt7++W41anCjcvLtv6WWv4cWvFkFUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBchfUrQS7HPCaomDkLqhbLeX/LZ7A5C6oWxr9u3i1UwCyF9ScvP+wIzj5C3IvnI9C9oKuxz+kK3aDkL2g6uNfz6rW8OQuqFsZLV4VH4LcBZ36hdEJy3TugpJDQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUB/gfLkLQJtpMAWQAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1"><span class="kw">hist</span>(x[,<span class="dv">1</span>],<span class="dt">xlab=</span><span class="st">&#39;Random numbers[x]&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1"><span class="kw">hist</span>(x[,<span class="dv">2</span>],<span class="dt">xlab=</span><span class="st">&#39;Random numbers[y]&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>因为抽样结果是二元的，故分开考虑<span class="math inline">\(x,y\)</span>的收敛性</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1">m&lt;-<span class="dv">20000</span></a>
<a class="sourceLine" id="cb116-2" title="2">k&lt;-<span class="dv">4</span></a>
<a class="sourceLine" id="cb116-3" title="3">X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>m<span class="op">-</span>b<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb116-4" title="4">Y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>m<span class="op">-</span>b<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb116-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) {</a>
<a class="sourceLine" id="cb116-6" title="6">  <span class="kw">set.seed</span>(i<span class="op">*</span><span class="dv">123</span>)</a>
<a class="sourceLine" id="cb116-7" title="7">  ff&lt;-<span class="kw">f2</span>(m)</a>
<a class="sourceLine" id="cb116-8" title="8">  X[i, ] &lt;-<span class="st"> </span><span class="kw">t</span>(ff[,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb116-9" title="9">  Y[i, ] &lt;-<span class="st"> </span><span class="kw">t</span>(ff[,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb116-10" title="10">}</a>
<a class="sourceLine" id="cb116-11" title="11">psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</a>
<a class="sourceLine" id="cb116-12" title="12"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi)) psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</a>
<a class="sourceLine" id="cb116-13" title="13"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</a>
<a class="sourceLine" id="cb116-14" title="14">   <span class="cf">if</span>(i<span class="op">==</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb116-15" title="15">      <span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>(m<span class="op">-</span>b<span class="op">+</span><span class="dv">1</span>),psi[i,], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="dt">ylab=</span><span class="kw">bquote</span>(phi))</a>
<a class="sourceLine" id="cb116-16" title="16">    }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb116-17" title="17">      <span class="kw">lines</span>(psi[i, ], <span class="dt">col=</span>i)</a>
<a class="sourceLine" id="cb116-18" title="18">    }</a>
<a class="sourceLine" id="cb116-19" title="19">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></a></code></pre></div>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1">rhat1 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m<span class="op">-</span>b<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb118-2" title="2"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(m<span class="op">-</span>b<span class="op">+</span><span class="dv">1</span>))  rhat1[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</a></code></pre></div>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1">X&lt;-Y</a>
<a class="sourceLine" id="cb119-2" title="2">psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</a>
<a class="sourceLine" id="cb119-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi)) psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</a>
<a class="sourceLine" id="cb119-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</a>
<a class="sourceLine" id="cb119-5" title="5">   <span class="cf">if</span>(i<span class="op">==</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb119-6" title="6">      <span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>(m<span class="op">-</span>b<span class="op">+</span><span class="dv">1</span>),psi[i,], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="dt">ylab=</span><span class="kw">bquote</span>(phi))</a>
<a class="sourceLine" id="cb119-7" title="7">    }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb119-8" title="8">      <span class="kw">lines</span>(psi[i, ], <span class="dt">col=</span>i)</a>
<a class="sourceLine" id="cb119-9" title="9">    }</a>
<a class="sourceLine" id="cb119-10" title="10">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1">rhat2 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m<span class="op">-</span>b<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb121-2" title="2"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(m<span class="op">-</span>b<span class="op">+</span><span class="dv">1</span>))  rhat2[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</a></code></pre></div>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1"><span class="kw">plot</span>(rhat1, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb122-2" title="2"><span class="kw">lines</span>(rhat2,<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb122-3" title="3"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb122-4" title="4"><span class="kw">legend</span>(<span class="st">&#39;topright&#39;</span>,<span class="kw">c</span>(<span class="kw">expression</span>(x),<span class="kw">expression</span>(y)),<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>如图大约在10000以后即可使得<span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
</div>
</div>
<div id="question-8" class="section level1">
<h1>Question</h1>
<p>1.Exercises 11.3 and 11.5 (pages 353-354, Statistical Computing with R)</p>
<p>2.Suppose <span class="math inline">\(T_1,\cdots,T_n\)</span> are i.i.d. samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_i = T_iI(T_i ≤ \tau ) + \tau I(T_i &gt; \tau ), i = 1,\cdots, n\)</span>. Suppose <span class="math inline">\(\tau = 1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: <span class="math display">\[0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85\]</span> Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the observed data MLE (note: <span class="math inline">\(Y_i\)</span> follows a mixture distribution)</p>
</div>
<div id="answer-8" class="section level1">
<h1>Answer</h1>
<div id="exercise-11.3" class="section level2">
<h2>Exercise 11.3</h2>
<p>(a)计算第k项的函数</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1">fk&lt;-<span class="cf">function</span>(a,k){</a>
<a class="sourceLine" id="cb123-2" title="2">  d&lt;-<span class="kw">length</span>(a)</a>
<a class="sourceLine" id="cb123-3" title="3">  rk&lt;-(<span class="op">-</span><span class="dv">1</span>)<span class="op">^</span>k<span class="op">/</span><span class="kw">factorial</span>(k)<span class="op">/</span>(<span class="dv">2</span><span class="op">^</span>k)<span class="op">*</span>(<span class="kw">sum</span>(a<span class="op">^</span><span class="dv">2</span>))<span class="op">^</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">gamma</span>((d<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">gamma</span>(k<span class="op">+</span><span class="dv">3</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">gamma</span>(k<span class="op">+</span>d<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb123-4" title="4">  <span class="kw">return</span>(rk)</a>
<a class="sourceLine" id="cb123-5" title="5">}</a>
<a class="sourceLine" id="cb123-6" title="6">a&lt;-<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb123-7" title="7"><span class="kw">fk</span>(a,<span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] -0.2380952</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1"><span class="kw">fk</span>(a,<span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.06613757</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1"><span class="kw">fk</span>(a,<span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] -0.01878908</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1"><span class="kw">fk</span>(a,<span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 0.005058599</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1"><span class="kw">fk</span>(a,<span class="dv">5</span>)</a></code></pre></div>
<pre><code>## [1] -0.00126465</code></pre>
<p>(b)求和函数</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1">f&lt;-<span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb133-2" title="2">  r&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb133-3" title="3">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">20</span>) {</a>
<a class="sourceLine" id="cb133-4" title="4">    <span class="cf">if</span>(<span class="kw">abs</span>(<span class="kw">fk</span>(a,i))<span class="op">&gt;</span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">5</span>))r&lt;-r<span class="op">+</span><span class="kw">fk</span>(a,i) <span class="cf">else</span> <span class="cf">break</span></a>
<a class="sourceLine" id="cb133-5" title="5">  }</a>
<a class="sourceLine" id="cb133-6" title="6">  <span class="kw">return</span>(<span class="kw">round</span>(r,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb133-7" title="7">}</a>
<a class="sourceLine" id="cb133-8" title="8"><span class="kw">f</span>(<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">5</span>))</a></code></pre></div>
<pre><code>## [1] -0.18671</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1"><span class="kw">f</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</a></code></pre></div>
<pre><code>## [1] -1.64224</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1"><span class="kw">f</span>(<span class="kw">rnorm</span>(<span class="dv">10</span>))</a></code></pre></div>
<pre><code>## [1] -0.31928</code></pre>
<p>(c)<span class="math inline">\(a=(1,2)^T\)</span></p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1">a&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb139-2" title="2"><span class="kw">f</span>(a)</a></code></pre></div>
<pre><code>## [1] -0.43134</code></pre>
</div>
<div id="exercise-11.5" class="section level2">
<h2>Exercise 11.5</h2>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1">g0&lt;-<span class="cf">function</span>(u,<span class="dt">k=</span><span class="dv">4</span>){</a>
<a class="sourceLine" id="cb141-2" title="2">  (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="dv">-1</span>))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb141-3" title="3">}</a>
<a class="sourceLine" id="cb141-4" title="4"></a>
<a class="sourceLine" id="cb141-5" title="5">gleft&lt;-<span class="cf">function</span>(a,<span class="dt">k=</span><span class="dv">4</span>){</a>
<a class="sourceLine" id="cb141-6" title="6">  <span class="dv">2</span><span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(pi<span class="op">*</span>(k<span class="dv">-1</span>))<span class="op">/</span><span class="kw">gamma</span>((k<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">integrate</span>(g0,<span class="dt">lower =</span> <span class="dv">0</span>,<span class="dt">upper =</span> <span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)))<span class="op">$</span>value</a>
<a class="sourceLine" id="cb141-7" title="7">}</a></code></pre></div>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" title="1">k0&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb142-2" title="2">res&lt;-<span class="kw">vector</span>(<span class="dt">length =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb142-3" title="3"><span class="cf">for</span> (k <span class="cf">in</span> k0) {</a>
<a class="sourceLine" id="cb142-4" title="4">  g&lt;-<span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb142-5" title="5">   <span class="kw">gleft</span>(a,k)<span class="op">-</span><span class="kw">gleft</span>(a,k<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb142-6" title="6">  }</a>
<a class="sourceLine" id="cb142-7" title="7">  solution&lt;-<span class="kw">uniroot</span>(g,<span class="dt">lower =</span> <span class="fl">0.1</span>,<span class="dt">upper =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb142-8" title="8">  res[<span class="kw">as.character</span>(k)]&lt;-<span class="kw">round</span>(<span class="kw">unlist</span>(solution),<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb142-9" title="9"></a>
<a class="sourceLine" id="cb142-10" title="10">}</a>
<a class="sourceLine" id="cb142-11" title="11">res</a></code></pre></div>
<pre><code>##       4       5       6       7       8       9      10      11      12      13 
## 1.34561 1.36121 1.37111 1.37793 1.38287 1.38667 1.38962 1.39199 1.39396 1.39557 
##      14      15      16      17      18      19      20      21      22      23 
## 1.39696 1.39815 1.39918 1.40008 1.40088 1.40159 1.40223 1.40280 1.40332 1.40379 
##      24      25     100 
## 1.40423 1.40462 1.41153</code></pre>
<p>因为<span class="math inline">\(k=500,1000\)</span>时，<span class="math inline">\(\Gamma(k)\)</span>过大，无法计算。显然，我们考虑的是a的正数解，由对称性，上述结果的相反数也是a的解。</p>
<p>与11.4对比</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" title="1">S&lt;-<span class="cf">function</span>(a,k){</a>
<a class="sourceLine" id="cb144-2" title="2">  <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k)</a>
<a class="sourceLine" id="cb144-3" title="3">}</a>
<a class="sourceLine" id="cb144-4" title="4">k0&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb144-5" title="5">res0&lt;-<span class="kw">vector</span>(<span class="dt">length =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb144-6" title="6"><span class="cf">for</span> (k <span class="cf">in</span> k0) {</a>
<a class="sourceLine" id="cb144-7" title="7">  SS&lt;-<span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb144-8" title="8">  <span class="kw">S</span>(a,k)<span class="op">-</span><span class="kw">S</span>(a,k<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb144-9" title="9">  }</a>
<a class="sourceLine" id="cb144-10" title="10">  solution&lt;-<span class="kw">uniroot</span>(SS,<span class="dt">lower =</span> <span class="fl">0.1</span>,<span class="dt">upper =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb144-11" title="11">  res0[<span class="kw">as.character</span>(k)]&lt;-<span class="kw">round</span>(<span class="kw">unlist</span>(solution),<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb144-12" title="12"></a>
<a class="sourceLine" id="cb144-13" title="13">}</a>
<a class="sourceLine" id="cb144-14" title="14"><span class="kw">rbind</span>(res0,<span class="kw">c</span>(res,<span class="dv">0</span>,<span class="dv">0</span>))</a></code></pre></div>
<pre><code>##            4       5       6       7       8       9      10      11      12
## res0 1.49210 1.53356 1.56276 1.58441 1.60119 1.61452 1.62539 1.63441 1.64203
##      1.34561 1.36121 1.37111 1.37793 1.38287 1.38667 1.38962 1.39199 1.39396
##           13      14      15      16      17      18      19      20      21
## res0 1.64854 1.65418 1.65910 1.66344 1.66730 1.67074 1.67383 1.67663 1.67917
##      1.39557 1.39696 1.39815 1.39918 1.40008 1.40088 1.40159 1.40223 1.40280
##           22      23      24      25     100     500    1000
## res0 1.68149 1.68362 1.68557 1.68737 1.72061 1.72975 1.73091
##      1.40332 1.40379 1.40423 1.40462 1.41153 0.00000 0.00000</code></pre>
<p>两种方式计算结果有误差，但是随着k的变化趋势是保持一致的.</p>
</div>
<div id="addition" class="section level2">
<h2>Addition</h2>
<p>EM方法：</p>
<p>E-step:<span class="math inline">\(E_{\lambda}[X^{(m)}]=\int_1^{+\infty}xP(X=x|X\ge1)dx=\int_1^{+\infty}xe^{\lambda}f(x)I_{(x\ge1)}dx=1+\frac{1}{\lambda}\)</span></p>
<p>M-step:<span class="math inline">\(L(\theta;X^{(0)},X^{(m)})=\prod^{n_1}_{i=1}(\lambda e^{-\lambda x^{(0)}_i})\prod^{n_2}_{j=1}(\lambda e^{-\lambda x^{(m)}_j})=\lambda^nexp(-\lambda(\sum_{i=1}^{n_1}x^{(0)}_i+\sum_{j=1}^{n_2}x^{(m)}_j))\)</span></p>
<p><span class="math inline">\(\frac{\partial\log L(\lambda)}{\partial\lambda}=\frac{n}{\lambda}-(\sum_{i=1}^{n_1}x^{(0)}_i+\sum_{j=1}^{n_2}x^{(m)}_j)\)</span></p>
<p><span class="math inline">\(\hat{\lambda}=\frac{n}{\sum_{i=1}^{n_1}x^{(0)}_i+\sum_{j=1}^{n_2}x^{(m)}_j}\)</span></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" title="1">N&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb146-2" title="2">l&lt;-<span class="kw">rep</span>(<span class="dv">2</span>,N)</a>
<a class="sourceLine" id="cb146-3" title="3">x0&lt;-<span class="kw">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>,  <span class="fl">0.91</span>,  <span class="fl">0.21</span>, <span class="fl">0.85</span>)</a>
<a class="sourceLine" id="cb146-4" title="4">n1&lt;-<span class="dv">7</span></a>
<a class="sourceLine" id="cb146-5" title="5">n2&lt;-<span class="dv">3</span></a>
<a class="sourceLine" id="cb146-6" title="6">n&lt;-<span class="dv">10</span></a>
<a class="sourceLine" id="cb146-7" title="7">eme&lt;-<span class="cf">function</span>(la){</a>
<a class="sourceLine" id="cb146-8" title="8">  <span class="kw">return</span>(<span class="dv">1</span><span class="op">+</span><span class="dv">1</span><span class="op">/</span>la)</a>
<a class="sourceLine" id="cb146-9" title="9">}</a>
<a class="sourceLine" id="cb146-10" title="10">emm&lt;-<span class="cf">function</span>(xm){</a>
<a class="sourceLine" id="cb146-11" title="11">  <span class="kw">return</span>(n<span class="op">/</span>(<span class="kw">sum</span>(x0)<span class="op">+</span><span class="kw">sum</span>(xm)))</a>
<a class="sourceLine" id="cb146-12" title="12">}</a>
<a class="sourceLine" id="cb146-13" title="13"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb146-14" title="14">  xm&lt;-<span class="kw">eme</span>(<span class="kw">rep</span>(l[k],n2))</a>
<a class="sourceLine" id="cb146-15" title="15">  l[k<span class="op">+</span><span class="dv">1</span>]&lt;-<span class="kw">emm</span>(xm)</a>
<a class="sourceLine" id="cb146-16" title="16">  <span class="cf">if</span>(<span class="kw">abs</span>(l[k<span class="op">+</span><span class="dv">1</span>]<span class="op">-</span>l[k])<span class="op">&lt;</span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">5</span>))<span class="cf">break</span></a>
<a class="sourceLine" id="cb146-17" title="17">}</a>
<a class="sourceLine" id="cb146-18" title="18">l[<span class="dv">1</span><span class="op">:</span>(k<span class="op">+</span><span class="dv">1</span>)]<span class="co">#收敛过程</span></a></code></pre></div>
<pre><code>##  [1] 2.000000 1.212121 1.084011 1.050696 1.041097 1.038252 1.037401 1.037146
##  [9] 1.037070 1.037047 1.037040</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" title="1">l[k<span class="op">+</span><span class="dv">1</span>]<span class="co">#EM方法结果</span></a></code></pre></div>
<pre><code>## [1] 1.03704</code></pre>
<p>MLE方法：</p>
<p><span class="math inline">\(L(\theta)=\prod^{n_1}_{i=1}(\lambda e^{-\lambda x^{(0)}_i})\prod^{n_2}_{j=1}P(T_j&gt;1)=\lambda^{n_1}exp(-\lambda(\sum_{i=1}^{n_1}x^{(0)}_i+n_2))\)</span></p>
<p><span class="math inline">\(\frac{\partial\log L(\lambda)}{\partial\lambda}=\frac{n_1}{\lambda}-(\sum_{i=1}^{n_1}x^{(0)}_i+m_2)\)</span></p>
<p><span class="math inline">\(\hat{\lambda}=\frac{n_1}{\sum_{i=1}^{n_1}x^{(0)}_i+n_2}\)</span></p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" title="1">n1<span class="op">/</span>(<span class="kw">sum</span>(x0)<span class="op">+</span>n2)</a></code></pre></div>
<pre><code>## [1] 1.037037</code></pre>
<p>对比：</p>
<p>EM和MLE两种方法得到结果基本一致。</p>
</div>
</div>
<div id="question-9" class="section level1">
<h1>Question</h1>
<p>1.Exercises 1 and 5 (page 204, Advanced R)</p>
<p>2.Excecises 1 and 7 (page 214, Advanced R)</p>
</div>
<div id="answer-9" class="section level1">
<h1>Answer</h1>
<div id="page-204-exercise-1" class="section level2">
<h2>page 204 Exercise 1</h2>
<p>Why are the following two invocations of <span class="math inline">\(lapply()\)</span> equivalent?</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" title="1">trims&lt;-<span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb152-2" title="2">x &lt;-<span class="st"> </span><span class="kw">rcauchy</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb152-3" title="3"><span class="kw">lapply</span>(trims, <span class="cf">function</span>(trim) <span class="kw">mean</span>(x, <span class="dt">trim =</span> trim))</a></code></pre></div>
<pre><code>## [[1]]
## [1] -0.8266766
## 
## [[2]]
## [1] -0.3311811
## 
## [[3]]
## [1] -0.3296715
## 
## [[4]]
## [1] -0.1091591</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" title="1"><span class="kw">lapply</span>(trims, mean, <span class="dt">x =</span> x)</a></code></pre></div>
<pre><code>## [[1]]
## [1] -0.8266766
## 
## [[2]]
## [1] -0.3311811
## 
## [[3]]
## [1] -0.3296715
## 
## [[4]]
## [1] -0.1091591</code></pre>
<p>第一条命令是指：对<span class="math inline">\(trims\)</span>向量中元素一一作用函数，函数定义为输出切除trim值的x的均值。</p>
<p>第二条命令是指：对<span class="math inline">\(trims\)</span>向量中元素一一作用函数<span class="math inline">\(mean\)</span>，而<span class="math inline">\(mean\)</span>的参数<span class="math inline">\(x=x\)</span>，<span class="math inline">\(trims\)</span>中元素则作为<span class="math inline">\(mean\)</span>的第二个参数<span class="math inline">\(trim\)</span>。</p>
</div>
<div id="page-204-exercise-5" class="section level2">
<h2>page 204 Exercise 5</h2>
<p>For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" title="1">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a></code></pre></div>
<p>第3题的模型：</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" title="1">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb157-2" title="2">  mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb157-3" title="3">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb157-4" title="4">  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb157-5" title="5">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb157-6" title="6">)</a></code></pre></div>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" title="1">mod1&lt;-<span class="kw">lapply</span>(formulas,lm,<span class="dt">data=</span> mtcars)</a>
<a class="sourceLine" id="cb158-2" title="2"><span class="kw">lapply</span>(mod1, rsq)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<p>第4题的模型：</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" title="1">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb160-2" title="2">rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb160-3" title="3">mtcars[rows, ]</a>
<a class="sourceLine" id="cb160-4" title="4">})</a></code></pre></div>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" title="1">mod2&lt;-<span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>disp)</a>
<a class="sourceLine" id="cb161-2" title="2"><span class="kw">lapply</span>(mod2, rsq)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.6382452
## 
## [[2]]
## [1] 0.6304606
## 
## [[3]]
## [1] 0.7978048
## 
## [[4]]
## [1] 0.704896
## 
## [[5]]
## [1] 0.7352706
## 
## [[6]]
## [1] 0.724599
## 
## [[7]]
## [1] 0.6745447
## 
## [[8]]
## [1] 0.7349265
## 
## [[9]]
## [1] 0.7225768
## 
## [[10]]
## [1] 0.7788106</code></pre>
</div>
<div id="page-214-exercise-1" class="section level2">
<h2>page 214 Exercise 1</h2>
<p>Use <span class="math inline">\(vapply()\)</span> to:</p>
<ul>
<li><ol style="list-style-type: lower-alpha">
<li>Compute the standard deviation of every column in a numeric data frame.</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" title="1">dt&lt;-<span class="kw">matrix</span>(<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>),<span class="dt">nrow =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb163-2" title="2">df&lt;-<span class="kw">data.frame</span>(dt)<span class="co">#一个20*5的numeric data frame</span></a>
<a class="sourceLine" id="cb163-3" title="3">df</a></code></pre></div>
<pre><code>##    X1 X2 X3 X4  X5
## 1  82 97 34 72  78
## 2   5  4 26 13  39
## 3  52 23 10 70  76
## 4  79 25 57 29  99
## 5  33 11 74 59   8
## 6   3 73 46 64  92
## 7  68 15 89 71  48
## 8  41 20  9 24  65
## 9  67 87 47 66  19
## 10 62 98 80 91  50
## 11 84 45 30 94  51
## 12 88 31 60 12  81
## 13 49 18 36 28   2
## 14 83 96 14 86  32
## 15 21 40 42 17 100
## 16 27 63  7 56  90
## 17 54 95 53 55  16
## 18 69 58 61 43  22
## 19 93 77 35 38  44
## 20 75  6 85  1  37</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" title="1"><span class="kw">vapply</span>(df,sd,<span class="dt">FUN.VALUE=</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>##       X1       X2       X3       X4       X5 
## 27.36666 34.07407 25.25423 28.02532 31.13210</code></pre>
<ul>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>Compute the standard deviation of every numeric column in a mixed data frame. (Hint: you’ll need to use <span class="math inline">\(vapply()\)</span> twice.)</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" title="1">dff&lt;-<span class="kw">cbind</span>(df,<span class="kw">rep</span>(<span class="st">&quot;a&quot;</span>,<span class="dv">20</span>),df<span class="op">+</span><span class="dv">4</span>,<span class="kw">rep</span>(<span class="st">&quot;b&quot;</span>,<span class="dv">20</span>))</a>
<a class="sourceLine" id="cb167-2" title="2"><span class="kw">colnames</span>(dff)&lt;-<span class="kw">as.character</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>) <span class="co">#一个20*12的mixed data frame</span></a>
<a class="sourceLine" id="cb167-3" title="3">dff</a></code></pre></div>
<pre><code>##     1  2  3  4   5 6  7   8  9 10  11 12
## 1  82 97 34 72  78 a 86 101 38 76  82  b
## 2   5  4 26 13  39 a  9   8 30 17  43  b
## 3  52 23 10 70  76 a 56  27 14 74  80  b
## 4  79 25 57 29  99 a 83  29 61 33 103  b
## 5  33 11 74 59   8 a 37  15 78 63  12  b
## 6   3 73 46 64  92 a  7  77 50 68  96  b
## 7  68 15 89 71  48 a 72  19 93 75  52  b
## 8  41 20  9 24  65 a 45  24 13 28  69  b
## 9  67 87 47 66  19 a 71  91 51 70  23  b
## 10 62 98 80 91  50 a 66 102 84 95  54  b
## 11 84 45 30 94  51 a 88  49 34 98  55  b
## 12 88 31 60 12  81 a 92  35 64 16  85  b
## 13 49 18 36 28   2 a 53  22 40 32   6  b
## 14 83 96 14 86  32 a 87 100 18 90  36  b
## 15 21 40 42 17 100 a 25  44 46 21 104  b
## 16 27 63  7 56  90 a 31  67 11 60  94  b
## 17 54 95 53 55  16 a 58  99 57 59  20  b
## 18 69 58 61 43  22 a 73  62 65 47  26  b
## 19 93 77 35 38  44 a 97  81 39 42  48  b
## 20 75  6 85  1  37 a 79  10 89  5  41  b</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" title="1">id&lt;-<span class="kw">vapply</span>(dff, is.numeric, <span class="dt">FUN.VALUE =</span> <span class="dv">1</span>)<span class="co">#判断</span></a>
<a class="sourceLine" id="cb169-2" title="2"><span class="kw">vapply</span>(dff[id],sd,<span class="dt">FUN.VALUE=</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>##        1      1.1      1.2      1.3      1.4      1.5      1.6      1.7 
## 27.36666 27.36666 27.36666 27.36666 27.36666 27.36666 27.36666 27.36666 
##      1.8      1.9 
## 27.36666 27.36666</code></pre>
</div>
<div id="page-214-exercise-7" class="section level2">
<h2>page 214 Exercise 7</h2>
<p>Implement <span class="math inline">\(mcsapply()\)</span>, a multicore version of <span class="math inline">\(sapply()\)</span>. Can you implement <span class="math inline">\(mcvapply()\)</span>, a parallel version of <span class="math inline">\(vapply()\)</span>? Why or why not?</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb171-1" title="1"><span class="kw">library</span>(parallel)</a>
<a class="sourceLine" id="cb171-2" title="2">mcsapply&lt;-<span class="cf">function</span>(X, FUN, ...,<span class="dt">mc.cores =</span> 1L, <span class="dt">simplify=</span><span class="ot">TRUE</span>, <span class="dt">USE.NAMES =</span> <span class="ot">TRUE</span>){</a>
<a class="sourceLine" id="cb171-3" title="3">  <span class="kw">makeCluster</span>(<span class="kw">getOption</span>(<span class="st">&quot;cl.cores&quot;</span>,mc.cores))-&gt;cl</a>
<a class="sourceLine" id="cb171-4" title="4">  mcl&lt;-<span class="kw">parLapply</span>(cl,X,FUN,<span class="dt">mc.cores =</span> mc.cores)</a>
<a class="sourceLine" id="cb171-5" title="5">  <span class="cf">if</span>(simplify<span class="op">==</span><span class="ot">TRUE</span>) mcl&lt;-<span class="kw">unlist</span>(mcl)</a>
<a class="sourceLine" id="cb171-6" title="6">  <span class="cf">if</span>(USE.NAMES<span class="op">==</span><span class="ot">FALSE</span>) <span class="kw">row.names</span>(mcl)&lt;-<span class="ot">NULL</span></a>
<a class="sourceLine" id="cb171-7" title="7">  <span class="kw">return</span>(mcl)</a>
<a class="sourceLine" id="cb171-8" title="8">}</a>
<a class="sourceLine" id="cb171-9" title="9"><span class="co">#参数取值对比</span></a>
<a class="sourceLine" id="cb171-10" title="10"><span class="kw">mcsapply</span>(df,mean)</a></code></pre></div>
<pre><code>##    X1    X2    X3    X4    X5 
## 56.75 49.10 44.75 49.45 52.45</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb173-1" title="1"><span class="kw">mcsapply</span>(df,mean,<span class="dt">simplify=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## $X1
## [1] 56.75
## 
## $X2
## [1] 49.1
## 
## $X3
## [1] 44.75
## 
## $X4
## [1] 49.45
## 
## $X5
## [1] 52.45</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" title="1"><span class="kw">mcsapply</span>(df,mean,<span class="dt">USE.NAMES =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>##    X1    X2    X3    X4    X5 
## 56.75 49.10 44.75 49.45 52.45</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" title="1"><span class="co">#时间对比</span></a>
<a class="sourceLine" id="cb177-2" title="2"><span class="kw">system.time</span>(<span class="kw">mcsapply</span>(df,mean))</a></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.00 0.05 0.41</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb179-1" title="1"><span class="kw">system.time</span>(<span class="kw">mcsapply</span>(df,mean,<span class="dt">mc.cores =</span> <span class="dv">2</span>))</a></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.00 0.03 0.45</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" title="1"><span class="kw">system.time</span>(<span class="kw">mcsapply</span>(df,mean,<span class="dt">mc.cores =</span> <span class="dv">4</span>))</a></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.00 0.05 0.69</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" title="1"><span class="kw">system.time</span>(<span class="kw">mcsapply</span>(df,mean,<span class="dt">mc.cores =</span> <span class="dv">8</span>))</a></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.01 0.14 1.41</code></pre>
<p><span class="math inline">\(vapply\)</span>类似于<span class="math inline">\(sapply\)</span>，提供了FUN.VALUE参数，用来控制返回值的行名，这样可以让程序更健壮。在多核运算中，得到的结果无法使用FUN.VALUE参数固定返回值，所以不能得到<span class="math inline">\(mcvapply\)</span></p>
</div>
<div id="question1" class="section level2">
<h2>Question1</h2>
<p>Write an Rcpp function for Exercise 9.8 (page 278, Statistical Computing with R).</p>
<p>Consider the bivariate density <span class="math display">\[f(x,y)\propto \binom{n}{x}y^{x+a-1}(1-y)^{n-x+b-1},x=0,1,\dots,n,0\le y\le1.\]</span> It can be shown that for fixed <span class="math inline">\(a, b, n\)</span>, the conditional distributions are Binomial(<span class="math inline">\(n, y\)</span>) and Beta(<span class="math inline">\(x + a, n − x + b\)</span>). Use the Gibbs sampler to generate a chain with target joint density <span class="math inline">\(f(x, y)\)</span>.</p>
</div>
<div id="answer1" class="section level2">
<h2>Answer1</h2>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb185-1" title="1"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb185-2" title="2"><span class="kw">cppFunction</span>(<span class="st">&#39;</span></a>
<a class="sourceLine" id="cb185-3" title="3"><span class="st">NumericMatrix gibbsc(int N,int burn,int a,int b,int n){</span></a>
<a class="sourceLine" id="cb185-4" title="4"><span class="st">  NumericMatrix X(N,2);</span></a>
<a class="sourceLine" id="cb185-5" title="5"><span class="st">  NumericMatrix XX(N-burn,2);</span></a>
<a class="sourceLine" id="cb185-6" title="6"><span class="st">  float x,y;</span></a>
<a class="sourceLine" id="cb185-7" title="7"><span class="st">  X(0,0)=1;</span></a>
<a class="sourceLine" id="cb185-8" title="8"><span class="st">  X(0,1)=0.5;</span></a>
<a class="sourceLine" id="cb185-9" title="9"><span class="st">  for(int i=1;i&lt;N;i++){</span></a>
<a class="sourceLine" id="cb185-10" title="10"><span class="st">    y=X(i-1,1);</span></a>
<a class="sourceLine" id="cb185-11" title="11"><span class="st">    X(i,0)=rbinom(1,n,y)[0];</span></a>
<a class="sourceLine" id="cb185-12" title="12"><span class="st">    x=X(i,0);</span></a>
<a class="sourceLine" id="cb185-13" title="13"><span class="st">    X(i,1)=rbeta(1,x+a,n-x+b)[0];</span></a>
<a class="sourceLine" id="cb185-14" title="14"><span class="st">  }</span></a>
<a class="sourceLine" id="cb185-15" title="15"><span class="st">  for(int k=0;k&lt;N-burn;k++){</span></a>
<a class="sourceLine" id="cb185-16" title="16"><span class="st">    XX(k,0)=X(k+burn,0);</span></a>
<a class="sourceLine" id="cb185-17" title="17"><span class="st">    XX(k,1)=X(k+burn,1);</span></a>
<a class="sourceLine" id="cb185-18" title="18"><span class="st">  }</span></a>
<a class="sourceLine" id="cb185-19" title="19"><span class="st">  return XX;</span></a>
<a class="sourceLine" id="cb185-20" title="20"><span class="st">}</span></a>
<a class="sourceLine" id="cb185-21" title="21"><span class="st">&#39;</span>)</a>
<a class="sourceLine" id="cb185-22" title="22">res1&lt;-<span class="kw">gibbsc</span>(<span class="dv">5000</span>,<span class="dv">1000</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">10</span>)</a></code></pre></div>
</div>
<div id="question2" class="section level2">
<h2>Question2</h2>
<p>Compare the corresponding generated random numbers with pure R language using the function “qqplot”.</p>
</div>
<div id="answer2" class="section level2">
<h2>Answer2</h2>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb186-1" title="1">gibbsr&lt;-<span class="cf">function</span>(N,burn,<span class="dt">a=</span><span class="dv">2</span>,<span class="dt">b=</span><span class="dv">2</span>,<span class="dt">n=</span><span class="dv">10</span>){</a>
<a class="sourceLine" id="cb186-2" title="2">  X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></a>
<a class="sourceLine" id="cb186-3" title="3">  <span class="co">###### generate the chain #####</span></a>
<a class="sourceLine" id="cb186-4" title="4">  X[<span class="dv">1</span>, ] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">.5</span>) <span class="co">#initialize</span></a>
<a class="sourceLine" id="cb186-5" title="5">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb186-6" title="6">    y &lt;-<span class="st"> </span>X[i<span class="dv">-1</span>, <span class="dv">2</span>]</a>
<a class="sourceLine" id="cb186-7" title="7">    X[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, n, y)</a>
<a class="sourceLine" id="cb186-8" title="8">    x &lt;-<span class="st"> </span>X[i, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb186-9" title="9">    X[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>,x<span class="op">+</span>a,n<span class="op">-</span>x<span class="op">+</span>b)</a>
<a class="sourceLine" id="cb186-10" title="10">    }</a>
<a class="sourceLine" id="cb186-11" title="11">  b &lt;-<span class="st"> </span>burn <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb186-12" title="12">  <span class="kw">return</span>(X[b<span class="op">:</span>N, ])</a>
<a class="sourceLine" id="cb186-13" title="13">}</a>
<a class="sourceLine" id="cb186-14" title="14">res2&lt;-<span class="kw">gibbsr</span>(<span class="dv">5000</span>,<span class="dv">1000</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">10</span>)</a></code></pre></div>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb187-1" title="1">a &lt;-<span class="st"> </span><span class="kw">ppoints</span>(<span class="dv">50</span>)</a>
<a class="sourceLine" id="cb187-2" title="2">Q1x &lt;-<span class="st"> </span><span class="kw">quantile</span>(res1[,<span class="dv">1</span>], a)   <span class="co">#quantiles of Cauchy</span></a>
<a class="sourceLine" id="cb187-3" title="3">Q2x &lt;-<span class="st"> </span><span class="kw">quantile</span>(res2[,<span class="dv">1</span>], a)</a>
<a class="sourceLine" id="cb187-4" title="4">Q1y &lt;-<span class="st"> </span><span class="kw">quantile</span>(res1[,<span class="dv">2</span>], a)   <span class="co">#quantiles of Cauchy</span></a>
<a class="sourceLine" id="cb187-5" title="5">Q2y &lt;-<span class="st"> </span><span class="kw">quantile</span>(res2[,<span class="dv">2</span>], a)</a>
<a class="sourceLine" id="cb187-6" title="6"><span class="kw">qqplot</span>(Q1x, Q2x, <span class="dt">main=</span><span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb187-7" title="7">        <span class="dt">xlab=</span><span class="st">&quot;Rcpp Quantiles of x&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R Quantiles of x&quot;</span>)</a>
<a class="sourceLine" id="cb187-8" title="8">    <span class="kw">abline</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb188-1" title="1"><span class="kw">qqplot</span>(Q1y, Q2y, <span class="dt">main=</span><span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb188-2" title="2">        <span class="dt">xlab=</span><span class="st">&quot;Rcpp Quantiles of y&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R Quantiles of y&quot;</span>)</a>
<a class="sourceLine" id="cb188-3" title="3">    <span class="kw">abline</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>根据Q-Q图可知两种方法得到的采样结果基本一致。</p>
</div>
<div id="question3" class="section level2">
<h2>Question3</h2>
<p>Campare the computation time of the two functions with the function “microbenchmark”.</p>
</div>
<div id="answer3" class="section level2">
<h2>Answer3</h2>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" title="1"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb189-2" title="2">ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">Rcpp=</span><span class="kw">gibbsc</span>(<span class="dv">5000</span>,<span class="dv">1000</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">10</span>),<span class="dt">R=</span><span class="kw">gibbsr</span>(<span class="dv">5000</span>,<span class="dv">1000</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb189-3" title="3"><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##   expr       lq   median       uq
## 1 Rcpp  2.09875  2.14205  2.27105
## 2    R 24.50800 25.73715 31.22405</code></pre>
<p>由表格对比可知，Rcpp中的函数运行速度比R中函数更快。</p>
</div>
<div id="question4" class="section level2">
<h2>Question4</h2>
<p>Comments your results.</p>
</div>
<div id="answer4" class="section level2">
<h2>Answer4</h2>
<p>通过用Rcpp和R中的函数完成Gibbs采样，对比采样结果和运行时间：两种方法的采样结果基本一致，Rcpp中的运行时间明显小于R中时间，具有更高的效率。但在编程过程中，Rcpp需要一些时间来构建cpp，因此如果是少量运算，R更有简易操作，如果是大量运算则采用Rcpp可以有效提高效率。</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
